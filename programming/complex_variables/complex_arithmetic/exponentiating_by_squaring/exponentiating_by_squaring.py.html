<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">################################################################################</span>
<span class="sd">#                                   LICENSE                                    #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   This file is part of mitx_mathematics_programming_examples.                #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   mitx_mathematics_programming_examples is free software: you can            #</span>
<span class="sd">#   redistribute it and/or modify it under the terms of the GNU General        #</span>
<span class="sd">#   Public License as published by the Free Software Foundation, either        #</span>
<span class="sd">#   version 3 of the License, or (at your option) any later version.           #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   mitx_mathematics_programming_examples is distributed in the hope that      #</span>
<span class="sd">#   it will be useful but WITHOUT ANY WARRANTY; without even the implied       #</span>
<span class="sd">#   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.           #</span>
<span class="sd">#   See the GNU General Public License for more details.                       #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   You should have received a copy of the GNU General Public License          #</span>
<span class="sd">#   along with mitx_mathematics_programming_examples. If not, see              #</span>
<span class="sd">#   &lt;https://www.gnu.org/licenses/&gt;.                                           #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   Purpose:                                                                   #</span>
<span class="sd">#       Computes powers using exponentiation by squaring.                      #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   Author: Ryan Maguire                                                       #</span>
<span class="sd">#   Date:   2025/03/28                                                         #</span>
<span class="sd">################################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Pylint doesn&#39;t like &quot;x&quot;, &quot;y&quot;, or &quot;z&quot; as variable names. Disable this warning.</span>
<span class="c1"># pylint: disable = invalid-name</span>

<span class="c1"># Computes z^n using exponentiation by squaring.</span>
<span class="k">def</span> <span class="nf">exp_by_squaring</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function:</span>
<span class="sd">            exp_by_squaring</span>
<span class="sd">        Purpose:</span>
<span class="sd">            Computes z^n using exponentiation by squaring.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            z (float, complex):</span>
<span class="sd">                Any real or complex number.</span>
<span class="sd">            n (int):</span>
<span class="sd">                The power z is being raised to.</span>
<span class="sd">        Output:</span>
<span class="sd">            z_pow (float, complex):</span>
<span class="sd">                The nth power of z, z^n.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Special case, z^0 = 1 by definition.</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="c1"># Start the squaring process at the input.</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">z</span>

    <span class="c1"># Negative powers are just powers of the reciprocal.</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">output</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Start the process. Compute z^n by removing all of the even factors</span>
    <span class="c1"># for n, iteratively updating the output along the way.</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

        <span class="c1"># If n is odd, n = 2*k+1, and if w = output, then:</span>
        <span class="c1">#</span>
        <span class="c1">#        n    2k + 1</span>
        <span class="c1">#       w  = w</span>
        <span class="c1">#</span>
        <span class="c1">#             -  2 -  n</span>
        <span class="c1">#          = | w    |   * w</span>
        <span class="c1">#             -    -</span>
        <span class="c1">#</span>
        <span class="c1"># Multiply &quot;scale&quot; by &quot;output&quot; to handle the &quot;* w&quot; on the right</span>
        <span class="c1"># side of the expression. We can continue squaring, replacing</span>
        <span class="c1"># output with output^2, to handle portion of this expression that</span>
        <span class="c1"># is inside of the parentheses.</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">*=</span> <span class="n">output</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="c1"># n is now even. Square the output and divide n by two.</span>
        <span class="n">output</span> <span class="o">*=</span> <span class="n">output</span>
        <span class="n">n</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>

    <span class="c1"># n is now 1. The final output is output * scale. Compute this.</span>
    <span class="k">return</span> <span class="n">output</span> <span class="o">*</span> <span class="n">scale</span>

<span class="c1"># Test our function with a short program.</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">z_val</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span>
    <span class="n">power</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
    <span class="n">z_pow</span> <span class="o">=</span> <span class="n">exp_by_squaring</span><span class="p">(</span><span class="n">z_val</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">z_pow</span><span class="p">)</span>
</pre></div>
