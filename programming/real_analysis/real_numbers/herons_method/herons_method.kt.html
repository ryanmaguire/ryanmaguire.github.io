<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates square roots using Heron&#39;s method.                         *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/18                                                        *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlin.math.abs</span>

<span class="cm">/******************************************************************************</span>
<span class="cm"> *  Function:                                                                 *</span>
<span class="cm"> *      heronsMethod                                                          *</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Computes square roots of positive real numbers using Heron&#39;s method.  *</span>
<span class="cm"> *  Arguments:                                                                *</span>
<span class="cm"> *      x (Double):                                                           *</span>
<span class="cm"> *          A positive real number, the input to the square root function.    *</span>
<span class="cm"> *  Output:                                                                   *</span>
<span class="cm"> *      sqrt_x (Double):                                                      *</span>
<span class="cm"> *          The square root of the input.                                     *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">heronsMethod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">):</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Heron&#39;s method is iterative and the convergence is quadratic. This    *</span>
<span class="cm">     *  means that if a_{n} has N correct decimals, then a_{n+1} will have    *</span>
<span class="cm">     *  2N correct decimals. A standard 64-bit double can fit about 16        *</span>
<span class="cm">     *  decimals of precision (the exact value is 2^-52 ~= 2.22x10^-16).      *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">maximumNumberOfIterations</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">epsilon</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.881784197001252E-16</span>

<span class="w">    </span><span class="cm">/*  Set the initial guess to the input. Provided x is positive, Heron&#39;s   *</span>
<span class="cm">     *  method will indeed converge.                                          */</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">approximateRoot</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>

<span class="w">    </span><span class="cm">/*  Iteratively loop through and obtain better approximations for sqrt(x).*/</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="n">maximumNumberOfIterations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  If we are within epsilon of the correct value we may break out of *</span>
<span class="cm">         *  this for-loop. Use the absolute value function to check.          */</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">approximateRoot</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">approximateRoot</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">            </span><span class="k">break</span>

<span class="w">        </span><span class="cm">/*  Apply Heron&#39;s method to get a better approximation for the root.  */</span>
<span class="w">        </span><span class="n">approximateRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">approximateRoot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">approximateRoot</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  As long as x is positive and not very large, we should have a very    *</span>
<span class="cm">     *  good approximation for sqrt(x). Heron&#39;s method will still work for    *</span>
<span class="cm">     *  very large x, but we must increase maximum_number_of_iterations.      */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">approximateRoot</span>
<span class="p">}</span>
<span class="cm">/*  End of heronsMethod.                                                      */</span>

<span class="cm">/*  Test out our function, compute the square root of 2.                      */</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sqrt_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">heronsMethod</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;sqrt(</span><span class="si">$</span><span class="n">x</span><span class="s">) = </span><span class="si">$</span><span class="n">sqrt_x</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*  We can run this using the Kotlin compiler, kotlinc:                       *</span>
<span class="cm"> *      https://github.com/JetBrains/kotlin/releases                          *</span>
<span class="cm"> *  See also:                                                                 *</span>
<span class="cm"> *      https://kotlinlang.org/                                               *</span>
<span class="cm"> *  You will also need to install Java OpenJDK. Once done, type:              *</span>
<span class="cm"> *      kotlinc herons_method.kt -d herons_method.jar                         *</span>
<span class="cm"> *      java -jar herons_method.jar                                           *</span>
<span class="cm"> *  This will output:                                                         *</span>
<span class="cm"> *      sqrt(2.0) = 1.414213562373095                                         *</span>
<span class="cm"> *  This has a relative error of 1.570092458683775E-16.                       *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  On Windows you can install kotlinc-native from the same link. Type:       *</span>
<span class="cm"> *      kotlinc-native herons_method.kt -output main.exe                      *</span>
<span class="cm"> *      main.exe                                                              *</span>
<span class="cm"> *  This produces the same output.                                            */</span>
</pre></div>
