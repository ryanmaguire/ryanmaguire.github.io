<div class="highlight"><pre><span></span><span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>                                   <span class="nv">LICENSE</span>                                    <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">This</span> <span class="s s-Atom">file</span> <span class="o">is</span> <span class="s s-Atom">part</span> <span class="s s-Atom">of</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>                <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">free</span> <span class="nn">software</span><span class="p">:</span> <span class="s s-Atom">you</span> <span class="s s-Atom">can</span>            <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">redistribute</span> <span class="s s-Atom">it</span> <span class="s s-Atom">and</span><span class="o">/</span><span class="s s-Atom">or</span> <span class="s s-Atom">modify</span> <span class="s s-Atom">it</span> <span class="s s-Atom">under</span> <span class="s s-Atom">the</span> <span class="s s-Atom">terms</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="p">;</span>
<span class="p">;</span>   <span class="nv">License</span> <span class="s s-Atom">as</span> <span class="s s-Atom">published</span> <span class="s s-Atom">by</span> <span class="s s-Atom">the</span> <span class="nv">Free</span> <span class="nv">Software</span> <span class="nv">Foundation</span><span class="p">,</span> <span class="s s-Atom">either</span> <span class="s s-Atom">version</span> <span class="mi">3</span> <span class="s s-Atom">of</span>  <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">the</span> <span class="nv">License</span><span class="p">,</span> <span class="nf">or</span> <span class="p">(</span><span class="s s-Atom">at</span> <span class="s s-Atom">your</span> <span class="s s-Atom">option</span><span class="p">)</span> <span class="s s-Atom">any</span> <span class="s s-Atom">later</span> <span class="s s-Atom">version</span><span class="p">.</span>                        <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">distributed</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">hope</span> <span class="s s-Atom">that</span> <span class="s s-Atom">it</span>   <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">will</span> <span class="s s-Atom">be</span> <span class="s s-Atom">useful</span> <span class="s s-Atom">but</span> <span class="nv">WITHOUT</span> <span class="nv">ANY</span> <span class="nv">WARRANTY</span><span class="p">;</span> <span class="s s-Atom">without</span> <span class="s s-Atom">even</span> <span class="s s-Atom">the</span> <span class="s s-Atom">implied</span> <span class="s s-Atom">warranty</span> <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">of</span> <span class="nv">MERCHANTABILITY</span> <span class="s s-Atom">or</span> <span class="nv">FITNESS</span> <span class="nv">FOR</span> <span class="nv">A</span> <span class="nv">PARTICULAR</span> <span class="nv">PURPOSE</span><span class="p">.</span>  <span class="nv">See</span> <span class="s s-Atom">the</span>           <span class="p">;</span>
<span class="p">;</span>   <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span> <span class="s s-Atom">for</span> <span class="s s-Atom">more</span> <span class="s s-Atom">details</span><span class="p">.</span>                               <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="nv">You</span> <span class="s s-Atom">should</span> <span class="s s-Atom">have</span> <span class="s s-Atom">received</span> <span class="s s-Atom">a</span> <span class="s s-Atom">copy</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span>          <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">along</span> <span class="s s-Atom">with</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>  <span class="nv">If</span> <span class="o">not</span><span class="p">,</span> <span class="s s-Atom">see</span>             <span class="p">;</span>
<span class="p">;</span>   <span class="o">&lt;</span><span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">www</span><span class="p">.</span><span class="s s-Atom">gnu</span><span class="p">.</span><span class="s s-Atom">org</span><span class="o">/</span><span class="s s-Atom">licenses/&gt;.</span>                                           <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Purpose</span><span class="s s-Atom">:</span>                                                                   <span class="p">;</span>
<span class="p">;</span>       <span class="nv">Calculates</span> <span class="s s-Atom">roots</span> <span class="s s-Atom">using</span> <span class="s s-Atom">the</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span><span class="p">.</span>                           <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Author</span><span class="s s-Atom">:</span> <span class="nv">Ryan</span> <span class="nv">Maguire</span>                                                       <span class="p">;</span>
<span class="p">;</span>   <span class="nv">Date</span><span class="s s-Atom">:</span>   <span class="mi">2025</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">22</span>                                                         <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="nv">FUNCTION</span> <span class="nv">HERON</span><span class="p">,</span> <span class="nv">X</span>

    <span class="p">;</span> <span class="nv">Tells</span> <span class="s s-Atom">the</span> <span class="s s-Atom">compiler</span> <span class="s s-Atom">that</span> <span class="s s-Atom">integers</span> <span class="s s-Atom">should</span> <span class="s s-Atom">be</span> <span class="mi">32</span> <span class="s s-Atom">bits</span><span class="p">,</span> <span class="o">not</span> <span class="mf">16.</span>
    <span class="nv">COMPILE_OPT</span> <span class="nv">IDL2</span>

    <span class="p">;</span> <span class="nv">Error</span> <span class="s s-Atom">checking</span> <span class="s s-Atom">code</span><span class="p">.</span>
    <span class="nv">ON_ERROR</span><span class="p">,</span> <span class="mi">2</span>

    <span class="p">;</span> <span class="nv">Heron</span><span class="s s-Atom">&#39;s method is iterative. The convergence is quadratic, meaning the</span>
<span class="s s-Atom">    ; number of accurate decimals doubles with each iteration. Because of this</span>
<span class="s s-Atom">    ; we can halt the algorithm after a few steps.</span>
<span class="s s-Atom">    MAXIMUM_NUMBER_OF_ITERATIONS = 16</span>

<span class="s s-Atom">    ; Maximum allowed error. This is double precision epsilon.</span>
<span class="s s-Atom">    EPSILON = 2.220446049250313E-16</span>

<span class="s s-Atom">    ; Variable used for Heron&#39;s</span> <span class="s s-Atom">approximation</span><span class="p">.</span> <span class="nv">We</span> <span class="s s-Atom">will</span> <span class="s s-Atom">iteratively</span> <span class="s s-Atom">update</span>
    <span class="p">;</span> <span class="s s-Atom">this</span> <span class="s s-Atom">value</span> <span class="s s-Atom">with</span> <span class="s s-Atom">better</span> <span class="s s-Atom">approximations</span> <span class="s s-Atom">using</span> <span class="nv">Heron</span><span class="s s-Atom">&#39;s method</span>
<span class="s s-Atom">    APPROXIMATE_ROOT = x</span>

<span class="s s-Atom">    ; Iteratively perform Heron&#39;s</span> <span class="s s-Atom">method</span><span class="p">.</span>
    <span class="nv">FOR</span> <span class="nv">ITERS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">MAXIMUM_NUMBER_OF_ITERATIONS</span> <span class="nv">DO</span> <span class="nv">BEGIN</span>

        <span class="p">;</span> <span class="nv">If</span> <span class="s s-Atom">the</span> <span class="s s-Atom">error</span> <span class="o">is</span> <span class="s s-Atom">small</span> <span class="s s-Atom">we</span> <span class="s s-Atom">can</span> <span class="s s-Atom">break</span> <span class="s s-Atom">out</span> <span class="s s-Atom">of</span> <span class="s s-Atom">this</span> <span class="s s-Atom">loop</span><span class="p">.</span>
        <span class="nv">ERROR</span> <span class="o">=</span> <span class="p">(</span><span class="nv">X</span> <span class="o">-</span> <span class="nv">APPROXIMATE_ROOT</span> <span class="o">*</span> <span class="nv">APPROXIMATE_ROOT</span><span class="p">)</span> <span class="o">/</span> <span class="nv">X</span>

        <span class="nv">IF</span> <span class="p">(</span><span class="nv">ABS</span><span class="p">(</span><span class="nv">ERROR</span><span class="p">)</span> <span class="nv">LE</span> <span class="nv">EPSILON</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BREAK</span>

        <span class="p">;</span> <span class="nv">Otherwise</span><span class="p">,</span> <span class="s s-Atom">improve</span> <span class="s s-Atom">our</span> <span class="s s-Atom">approximation</span> <span class="s s-Atom">using</span> <span class="nv">Heron</span><span class="s s-Atom">&#39;s method.</span>
<span class="s s-Atom">        APPROXIMATE_ROOT = 0.5 * (APPROXIMATE_ROOT + X / APPROXIMATE_ROOT)</span>

<span class="s s-Atom">    END</span>

<span class="s s-Atom">    ; If x is positive and not too big, APPROXIMATE_ROOT should have a</span>
<span class="s s-Atom">    ; very accurate approximation to sqrt(x). Heron&#39;s</span> <span class="s s-Atom">method</span> <span class="s s-Atom">works</span> <span class="s s-Atom">for</span>
    <span class="p">;</span> <span class="s s-Atom">large</span> <span class="s s-Atom">inputs</span> <span class="s s-Atom">as</span> <span class="s s-Atom">well</span><span class="p">,</span> <span class="s s-Atom">but</span> <span class="s s-Atom">we</span> <span class="s s-Atom">need</span> <span class="s s-Atom">to</span> <span class="s s-Atom">increase</span> <span class="s s-Atom">the</span> <span class="s s-Atom">value</span> <span class="s s-Atom">of</span>
    <span class="p">;</span> <span class="nv">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="p">.</span>
    <span class="nv">RETURN</span><span class="p">,</span> <span class="nv">APPROXIMATE_ROOT</span>

<span class="nv">END</span>

<span class="p">;</span> <span class="nv">Program</span> <span class="s s-Atom">for</span> <span class="s s-Atom">testing</span> <span class="s s-Atom">our</span> <span class="s s-Atom">implementation</span> <span class="s s-Atom">of</span> <span class="nv">Heron</span><span class="s s-Atom">&#39;s method.</span>
<span class="s s-Atom">PRO MAIN</span>

<span class="s s-Atom">    COMPILE_OPT IDL2</span>

<span class="s s-Atom">    ; The input for the method. We&#39;ll</span> <span class="s s-Atom">compute</span> <span class="nf">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span>
    <span class="nv">X</span> <span class="o">=</span> <span class="nv">DOUBLE</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="p">;</span> <span class="nv">Run</span> <span class="s s-Atom">the</span> <span class="s s-Atom">routine</span><span class="p">,</span> <span class="s s-Atom">computing</span> <span class="nf">sqrt</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">),</span> <span class="s s-Atom">and</span> <span class="s s-Atom">print</span> <span class="s s-Atom">the</span> <span class="s s-Atom">result</span><span class="p">.</span>
    <span class="nv">SQRT_2</span> <span class="o">=</span> <span class="nv">HERON</span><span class="p">(</span><span class="nv">X</span><span class="p">)</span>
    <span class="nv">PRINT</span><span class="p">,</span> <span class="nv">X</span><span class="p">,</span> <span class="nv">SQRT_2</span><span class="p">,</span> <span class="nv">FORMAT</span> <span class="o">=</span> <span class="s s-Atom">&#39;SQRT(%3.1f) = %18.16f&#39;</span>

<span class="nv">END</span>

<span class="p">;</span> <span class="nv">We</span> <span class="s s-Atom">can</span> <span class="s s-Atom">run</span> <span class="s s-Atom">this</span> <span class="s s-Atom">by</span> <span class="s s-Atom">installing</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">Data</span> <span class="nv">Language</span> <span class="p">(</span><span class="nv">GDL</span><span class="p">),</span> <span class="s s-Atom">which</span> <span class="o">is</span>
<span class="p">;</span> <span class="s s-Atom">a</span> <span class="s s-Atom">free</span> <span class="s s-Atom">and</span> <span class="s s-Atom">open</span> <span class="s s-Atom">source</span> <span class="s s-Atom">alternative</span> <span class="s s-Atom">to</span> <span class="nv">IDL</span><span class="s s-Atom">:</span>
<span class="p">;</span>   <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">gnudatalanguage</span><span class="p">.</span><span class="s s-Atom">github</span><span class="p">.</span><span class="s s-Atom">io</span><span class="o">/</span>
<span class="p">;</span> <span class="nv">Once</span> <span class="s s-Atom">installed</span><span class="p">,</span> <span class="s s-Atom">start</span> <span class="nv">GDL</span> <span class="s s-Atom">by</span> <span class="s s-Atom">typing</span> <span class="s s-Atom">gdl</span><span class="p">.</span> <span class="nv">Once</span> <span class="s s-Atom">running</span><span class="p">,</span> <span class="nn">type</span><span class="p">:</span>
<span class="p">;</span>   <span class="nv">GDL</span><span class="o">&gt;</span> <span class="p">.</span><span class="s s-Atom">compile</span> <span class="s s-Atom">herons_method</span><span class="p">.</span><span class="s s-Atom">pro</span>
<span class="p">;</span>   <span class="nv">GDL</span><span class="o">&gt;</span> <span class="s s-Atom">main</span>
<span class="p">;</span> <span class="nv">This</span> <span class="s s-Atom">will</span> <span class="s s-Atom">produce</span> <span class="s s-Atom">the</span> <span class="s s-Atom">following</span> <span class="nn">output</span><span class="p">:</span>
<span class="p">;</span>   <span class="nv">SQRT</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.4142135623730949</span>
<span class="p">;</span> <span class="nv">The</span> <span class="s s-Atom">relative</span> <span class="s s-Atom">error</span> <span class="o">is</span> <span class="mf">1.570092458683775E-16</span><span class="p">.</span>
</pre></div>
