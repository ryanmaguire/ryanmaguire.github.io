<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates square roots using Heron&#39;s method.                         *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/03/08                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  fabs (floating-point absolute value) found here.                          */</span>
<span class="kd">import</span> <span class="nc">Foundation</span>

<span class="cm">/*  Heron&#39;s method is iterative and the convergence is quadratic. This means  *</span>
<span class="cm"> *  that if a_{n} has N correct decimals, then a_{n+1} will have 2N correct   *</span>
<span class="cm"> *  decimals. A standard 64-bit double can fit about 16 decimals of precision *</span>
<span class="cm"> *  (the exact value is 2^-52 ~= 2.22x10^-16). Because of this we may exit    *</span>
<span class="cm"> *  the function after a few iterations.                                      */</span>
<span class="kd">let</span> <span class="nv">maximum_number_of_iterations</span><span class="p">:</span> <span class="nb">UInt32</span> <span class="p">=</span> <span class="mi">16</span>

<span class="cm">/*  The maximum allowed error. This is double precision epsilon.              */</span>
<span class="kd">let</span> <span class="nv">epsilon</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="mf">2.220446049250313E-16</span>

<span class="cm">/*  Function for computing square roots using Heron&#39;s method.                 */</span>
<span class="kd">func</span> <span class="nf">heronsMethod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">Double</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Double</span> <span class="p">{</span>

    <span class="cm">/*  Starting value for Heron&#39;s method. The input will suffice.            */</span>
    <span class="kd">var</span> <span class="nv">approximate_root</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">x</span>

    <span class="cm">/*  Loop through and iteratively perform Heron&#39;s method.                  */</span>
    <span class="k">for</span> <span class="kc">_</span> <span class="k">in</span> <span class="mi">0</span> <span class="p">..</span><span class="o">&lt;</span> <span class="n">maximum_number_of_iterations</span> <span class="p">{</span>

        <span class="cm">/*  If the error is small enough we can break out of the loop. We     *</span>
<span class="cm">         *  want small relative error, so compute this.                       */</span>
        <span class="kd">let</span> <span class="nv">error</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">approximate_root</span> <span class="o">*</span> <span class="n">approximate_root</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span>

        <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>

        <span class="cm">/*  Otherwise improve the error by applying Heron&#39;s method.           */</span>
        <span class="n">approximate_root</span> <span class="p">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">approximate_root</span> <span class="o">+</span> <span class="n">x</span> <span class="o">/</span> <span class="n">approximate_root</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="cm">/*  As long as x is positive and not very large, we should have a very    *</span>
<span class="cm">     *  good approximation for sqrt(x). Heron&#39;s method works for large x, but *</span>
<span class="cm">     *  we may need to increasethe value of maximum_number_of_iterations.     */</span>
    <span class="k">return</span> <span class="n">approximate_root</span>
<span class="p">}</span>

<span class="cm">/*  Test out Heron&#39;s method by computing sqrt(2).                             */</span>
<span class="kd">let</span> <span class="nv">x</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="mf">2.0</span>
<span class="kd">let</span> <span class="nv">sqrt_x</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">heronsMethod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="bp">print</span><span class="p">(</span><span class="s">&quot;sqrt(</span><span class="si">\(</span><span class="n">x</span><span class="si">)</span><span class="s">) = </span><span class="si">\(</span><span class="n">sqrt_x</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>

<span class="cm">/*  We can run this using the standard swift compiler, swiftc:                *</span>
<span class="cm"> *      https://www.swift.org/install/                                        *</span>
<span class="cm"> *  After installing, on GNU, Linux, or macOS, type:                          *</span>
<span class="cm"> *      swiftc herons_method.swift -o main                                    *</span>
<span class="cm"> *      ./main                                                                *</span>
<span class="cm"> *  This will output the following:                                           *</span>
<span class="cm"> *      sqrt(2.0) = 1.414213562373095                                         *</span>
<span class="cm"> *  This has a relative error of 1.570092458683775E-16.                       *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  On Windows, type:                                                         *</span>
<span class="cm"> *      swiftc herons_method.swift -o main.exe                                *</span>
<span class="cm"> *      main.exe                                                              *</span>
<span class="cm"> *  This will produce the same output.                                        */</span>
</pre></div>
