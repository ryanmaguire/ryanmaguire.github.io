<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ryan Maguire | Mathematics, Physics, and Programming</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Ryan Maguire" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Mathematics, Physics, and Programming" />
<meta property="og:description" content="Mathematics, Physics, and Programming" />
<link rel="canonical" href="https://github.com/ryanmaguire/programming/real_analysis/continuous_functions/steffensens_method" />
<meta property="og:url" content="https://github.com/ryanmaguire/programming/real_analysis/continuous_functions/steffensens_method" />
<meta property="og:site_name" content="Ryan Maguire" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ryan Maguire" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Mathematics, Physics, and Programming","headline":"Ryan Maguire","url":"https://github.com/ryanmaguire/programming/real_analysis/continuous_functions/steffensens_method"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://github.com/ryanmaguire/feed.xml" title="Ryan Maguire" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Ryan Maguire</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/asymptote/">Asymptote</a><a class="page-link" href="/papers/">Papers</a><a class="page-link" href="/presentations/">Presentations</a><a class="page-link" href="/programming/">Programming</a><a class="page-link" href="/projects/">Projects</a><a class="page-link" href="/teaching/">Teaching</a><a class="page-link" href="/threejs/">Three.js</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <p><a href="../"><strong>Back</strong></a></p>

<h2 id="r">R<br /></h2>
<div class="highlight"><pre><span></span><span class="c">################################################################################</span>
<span class="c">#                                   LICENSE                                    #</span>
<span class="c">################################################################################</span>
<span class="c">#   This file is part of mitx_mathematics_programming_examples.                #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   mitx_mathematics_programming_examples is free software: you can            #</span>
<span class="c">#   redistribute it and/or modify it under the terms of the GNU General Public #</span>
<span class="c">#   License as published by the Free Software Foundation, either version 3 of  #</span>
<span class="c">#   the License, or (at your option) any later version.                        #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   mitx_mathematics_programming_examples is distributed in the hope that it   #</span>
<span class="c">#   will be useful, but WITHOUT ANY WARRANTY; without even the implied         #</span>
<span class="c">#   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  #</span>
<span class="c">#   GNU General Public License for more details.                               #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   You should have received a copy of the GNU General Public License          #</span>
<span class="c">#   along with mitx_mathematics_programming_examples.  If not, see             #</span>
<span class="c">#   &lt;https://www.gnu.org/licenses/&gt;.                                           #</span>
<span class="c">################################################################################</span>
<span class="c">#   Purpose:                                                                   #</span>
<span class="c">#       Calculates roots of a function using Steffensen&#39;s method.              #</span>
<span class="c">################################################################################</span>
<span class="c">#   Author:     Ryan Maguire                                                   #</span>
<span class="c">#   Date:       May 25, 2025.                                                  #</span>
<span class="c">################################################################################</span>

<span class="c"># Computes the root of a function using Steffensen&#39;s method.</span>
<span class="c">steffensen &lt;- function(f, x) {</span>

<span class="c">    # Steffensen&#39;s method is iterative and converges very quickly.</span>
<span class="c">    # Because of this we may exit the function after a few iterations.</span>
<span class="c">    maximum_number_of_iterations &lt;- 64</span>

<span class="c">    # The maximum allowed error. This is 4x double precision epsilon.</span>
<span class="c">    epsilon &lt;- 8.881784197001252E-16</span>

<span class="c">    # The method starts at the provided guess point and updates iteratively.</span>
<span class="c">    xn &lt;- x</span>

<span class="c">    # Iteratively apply Steffensen&#39;s method to find the root.</span>
<span class="c">    for (iters in 1:maximum_number_of_iterations) {</span>

<span class="c">        # Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
<span class="c">        # in particular the denominator is f(x + f(x)) / f(x) - 1. Compute.</span>
<span class="c">        f_xn &lt;- f(xn)</span>
<span class="c">        g_xn &lt;- f(xn + f_xn) / f_xn - 1.0</span>

<span class="c">        # Like Newton&#39;s method, the new point is obtained by subtracting</span>
<span class="c">        # the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative</span>
<span class="c">        # of f, but we do not explicitly need to calculate f&#39;(x).</span>
<span class="c">        xn &lt;- xn - f_xn / g_xn</span>

<span class="c">        # If f(x) is very small, we are close to a root and can break out</span>
<span class="c">        # of this for loop. Check for this.</span>
<span class="c">        if (abs(f_xn) &lt; epsilon) {</span>
<span class="c">            break</span>
<span class="c">        }</span>
<span class="c">    }</span>

<span class="c">    # Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
<span class="c">    # quadratic. After a few iterations we will be very to close a root.</span>
<span class="c">    return(xn)</span>
<span class="c">}</span>
<span class="c"># End of steffensen.</span>

<span class="c"># sqrt(2) is a root to the function f(x) = 2 - x^2.</span>
<span class="c">f &lt;- function(x) {</span>
<span class="c">    return(2.0 - x*x)</span>
<span class="c">}</span>

<span class="c"># The initial guess point for Steffensen&#39;s method.</span>
<span class="c">x &lt;- 2.0</span>

<span class="c"># Calculate the square root and print it to the screen. If we have</span>
<span class="c"># written things correctly, we should get 1.414..., which is sqrt(2).</span>
<span class="c">sqrt_x &lt;- steffensen(f, x)</span>
<span class="c">output = sprintf(&quot;sqrt(2) = %.16f&quot;, sqrt_x)</span>
<span class="c">message(output)</span>
</pre></div>

<h2 id="js">Js<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">steffensensMethod</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">EPSILON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Variable for keeping track of how many iterations we perform.         */</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">iters</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">iters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">fXn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">gXn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fXn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">fXn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="nx">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">fXn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">gXn</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">fXn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">EPSILON</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xn</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensensMethod.                                                 */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*  The initial guess point for Steffensen&#39;s method.                          */</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="cm">/*  Calculate the square root and print it to the screen. If we have          *</span>
<span class="cm"> *  written things correctly, we should get 1.414..., which is sqrt(2).       */</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">sqrtX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">steffensensMethod</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;sqrt(&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">sqrtX</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">16</span><span class="p">));</span>
</pre></div>

<h2 id="f90">F90<br /></h2>
<div class="highlight"><pre><span></span><span class="c">!------------------------------------------------------------------------------!</span>
<span class="c">!                                   LICENSE                                    !</span>
<span class="c">!------------------------------------------------------------------------------!</span>
<span class="c">!   This file is part of mitx_mathematics_programming_examples.                !</span>
<span class="c">!                                                                              !</span>
<span class="c">!   mitx_mathematics_programming_examples is free software: you can            !</span>
<span class="c">!   redistribute it and/or modify it under the terms of the GNU General Public !</span>
<span class="c">!   License as published by the Free Software Foundation, either version 3 of  !</span>
<span class="c">!   the License, or (at your option) any later version.                        !</span>
<span class="c">!                                                                              !</span>
<span class="c">!   mitx_mathematics_programming_examples is distributed in the hope that it   !</span>
<span class="c">!   will be useful but WITHOUT ANY WARRANTY; without even the implied warranty !</span>
<span class="c">!   of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           !</span>
<span class="c">!   GNU General Public License for more details.                               !</span>
<span class="c">!                                                                              !</span>
<span class="c">!   You should have received a copy of the GNU General Public License          !</span>
<span class="c">!   along with mitx_mathematics_programming_examples.  If not, see             !</span>
<span class="c">!   &lt;https://www.gnu.org/licenses/&gt;.                                           !</span>
<span class="c">!------------------------------------------------------------------------------!</span>
<span class="c">!   Purpose:                                                                   !</span>
<span class="c">!       Calculates roots using Steffensen&#39;s method.                            !</span>
<span class="c">!------------------------------------------------------------------------------!</span>
<span class="c">!   Author: Ryan Maguire                                                       !</span>
<span class="c">!   Date:   2025/05/25                                                         !</span>
<span class="c">!------------------------------------------------------------------------------!</span>
<span class="k">MODULE </span><span class="n">STEFFENSEN</span>

<span class="w">    </span><span class="k">IMPLICIT NONE</span>

<span class="w">    </span><span class="c">! Steffensen&#39;s method is iterative. The convergence is quadratic, meaning</span>
<span class="w">    </span><span class="c">! the number of accurate decimals doubles with each iteration. Because of</span>
<span class="w">    </span><span class="c">! this we can halt the algorithm after a few steps.</span>
<span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span>

<span class="w">    </span><span class="c">! Maximum allowed error. This is 4x double precision epsilon.</span>
<span class="w">    </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">EPSILON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span>

<span class="w">    </span><span class="k">CONTAINS</span>

<span class="w">    </span><span class="c">!--------------------------------------------------------------------------!</span>
<span class="w">    </span><span class="c">!   Function:                                                              !</span>
<span class="w">    </span><span class="c">!       STEFFENSENS_METHOD                                                 !</span>
<span class="w">    </span><span class="c">!   Purpose:                                                               !</span>
<span class="w">    </span><span class="c">!       Computes roots using Steffensen&#39;s method.                          !</span>
<span class="w">    </span><span class="c">!   Arguments:                                                             !</span>
<span class="w">    </span><span class="c">!       FUNC (FUNCTION):                                                   !</span>
<span class="w">    </span><span class="c">!           A function f: R -&gt; R.                                          !</span>
<span class="w">    </span><span class="c">!       X (REAL):                                                          !</span>
<span class="w">    </span><span class="c">!           The initial guess for the root of func.                        !</span>
<span class="w">    </span><span class="c">!   OUTPUT:                                                                !</span>
<span class="w">    </span><span class="c">!       ROOT (REAL):                                                       !</span>
<span class="w">    </span><span class="c">!           A root for FUNC.                                               !</span>
<span class="w">    </span><span class="c">!--------------------------------------------------------------------------!</span>
<span class="w">    </span><span class="k">FUNCTION </span><span class="n">STEFFENSENS_METHOD</span><span class="p">(</span><span class="n">FUNC</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">)</span>

<span class="w">        </span><span class="k">IMPLICIT NONE</span>

<span class="w">        </span><span class="c">! FUNC is a function f: R -&gt; R. Define this.</span>
<span class="w">        </span><span class="k">INTERFACE</span>
<span class="k">            FUNCTION </span><span class="n">FUNC</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="w">                </span><span class="k">IMPLICIT NONE</span>
<span class="k">                </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span>
<span class="w">                </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">FUNC</span>
<span class="w">            </span><span class="k">END FUNCTION </span><span class="n">FUNC</span>
<span class="w">        </span><span class="k">END INTERFACE</span>

<span class="w">        </span><span class="c">! The input is a real number, the guess for Steffensen&#39;s method.</span>
<span class="w">        </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span>

<span class="w">        </span><span class="c">! The output is also a positive real number, the root of FUNC.</span>
<span class="w">        </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">STEFFENSENS_METHOD</span>

<span class="w">        </span><span class="c">! Dummy variable for keeping track of how many iterations we&#39;ve done.</span>
<span class="w">        </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ITERS</span>

<span class="w">        </span><span class="c">! Steffensen&#39;s method is similar to Newton&#39;s method. At each step we</span>
<span class="w">        </span><span class="c">! Calculate the function F evaluated at the new approximation, and</span>
<span class="w">        </span><span class="c">! also compute a function G that acts as the derivative of F. Provide</span>
<span class="w">        </span><span class="c">! variables for these two evaluations.</span>
<span class="w">        </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">F_XN</span><span class="p">,</span><span class="w"> </span><span class="n">G_XN</span>

<span class="w">        </span><span class="c">! Variable for the updated approximations.</span>
<span class="w">        </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">XN</span>

<span class="w">        </span><span class="c">! Steffensen&#39;s method starts the process at the guess point.</span>
<span class="w">        </span><span class="n">XN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span>

<span class="w">        </span><span class="c">! Iteratively perform Steffensen&#39;s method.</span>
<span class="w">        </span><span class="k">DO </span><span class="n">ITERS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MAXIMUM_NUMBER_OF_ITERATIONS</span>

<span class="w">            </span><span class="c">! Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
<span class="w">            </span><span class="c">! in particular the denominator is f(x + f(x)) / f(x) - 1.</span>
<span class="w">            </span><span class="n">F_XN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FUNC</span><span class="p">(</span><span class="n">XN</span><span class="p">)</span>
<span class="w">            </span><span class="n">G_XN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FUNC</span><span class="p">(</span><span class="n">XN</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">F_XN</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">F_XN</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span>

<span class="w">            </span><span class="c">! Like Newton&#39;s method the new point is obtained by subtracting</span>
<span class="w">            </span><span class="c">! the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative</span>
<span class="w">            </span><span class="c">! of f, but we do not explicitly need to calculate f&#39;(x).</span>
<span class="w">            </span><span class="n">XN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XN</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">F_XN</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">G_XN</span>

<span class="w">            </span><span class="c">! If f(x) is very small, we are close to a root and can break</span>
<span class="w">            </span><span class="c">! out of this loop. Check for this.</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">F_XN</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="w"> </span><span class="nb">EPSILON</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                EXIT</span>
<span class="k">            END IF</span>

<span class="k">        END DO</span>

<span class="w">        </span><span class="c">! Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
<span class="w">        </span><span class="c">! quadratic. After a few iterations we will be very to close a root.</span>
<span class="w">        </span><span class="n">STEFFENSENS_METHOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XN</span>
<span class="w">    </span><span class="k">END FUNCTION </span><span class="n">STEFFENSENS_METHOD</span>

<span class="w">    </span><span class="c">! Provide the function f(x) = 2 - x^2. sqrt(2) is a root.</span>
<span class="w">    </span><span class="k">FUNCTION </span><span class="n">FUNC</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="w">        </span><span class="k">IMPLICIT NONE</span>
<span class="k">        </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span>
<span class="w">        </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">FUNC</span>
<span class="w">        </span><span class="n">FUNC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span>

<span class="w">    </span><span class="k">END FUNCTION </span><span class="n">FUNC</span>

<span class="k">END MODULE </span><span class="n">STEFFENSEN</span>

<span class="c">! Program for testing our implementation of Steffensen&#39;s method.</span>
<span class="k">PROGRAM </span><span class="n">MAIN</span>

<span class="w">    </span><span class="k">USE </span><span class="n">STEFFENSEN</span>
<span class="w">    </span><span class="k">IMPLICIT NONE</span>

<span class="w">    </span><span class="c">! 2 is close enough to sqrt(2) for Steffensen&#39;s method to converge.</span>
<span class="w">    </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>

<span class="w">    </span><span class="c">! Variable for the output.</span>
<span class="w">    </span><span class="kt">REAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">SQRT_2</span>

<span class="w">    </span><span class="c">! Run the routine, compute sqrt(2), and print the result.</span>
<span class="w">    </span><span class="n">SQRT_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STEFFENSENS_METHOD</span><span class="p">(</span><span class="n">FUNC</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">)</span>
<span class="w">    </span><span class="k">PRINT</span><span class="w"> </span><span class="s2">&quot;(A,F18.16)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sqrt(2) = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SQRT_2</span>

<span class="k">END PROGRAM </span><span class="n">MAIN</span>
</pre></div>

<h2 id="cs">Cs<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/21                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Console.WriteLine and Math.Abs are both provided here.                    */</span>
<span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span>

<span class="cm">/*  Create an alias for functions of the form f: R -&gt; R.                      */</span>
<span class="k">using</span><span class="w"> </span><span class="nn">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/*  Class providing an implementation of Steffensen&#39;s method.                 */</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Steffensen</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="n">maximumNumberOfIterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="n">U</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.            */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">Root</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  Variable for keeping track of how many iterations we perform.     */</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="n">iters</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  The method starts at the guess point and updates iteratively.     */</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.           */</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maximumNumberOfIterations</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">iters</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x+f(x)), *</span>
<span class="cm">             *  in particular the denominator is f(x + f(x)) / f(x) - 1.      */</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">g_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1.0</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  Like Newton&#39;s method the new point is obtained by subtracting *</span>
<span class="cm">             *  the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative *</span>
<span class="cm">             *  of f, but we do not explicitly need to calculate f&#39;(x).       */</span>
<span class="w">            </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break   *</span>
<span class="cm">             *  out of this for loop. Check for this.                         */</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is *</span>
<span class="cm">         *  quadratic. After a few iterations we will be very to close a root.*/</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/*  End of Root.                                                          */</span>

<span class="w">    </span><span class="cm">/*  The function we&#39;ll test. The roots are +/- sqrt(2).                   */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Main routine used for testing our Steffensen implementation.          */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                  */</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have  *</span>
<span class="cm">         *  written things correctly we should get 1.414..., which is sqrt(2).*/</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;sqrt({x}) = {sqrt_x}&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="rs">Rs<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Type for a function of the form f: R -&gt; R.                                */</span>
<span class="k">type</span> <span class="nc">RealFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="kt">f64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">f64</span><span class="p">;</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="k">fn</span> <span class="nf">steffensens_method</span><span class="p">(</span><span class="n">f</span>: <span class="nc">RealFunc</span><span class="p">,</span><span class="w"> </span><span class="n">x</span>: <span class="kt">f64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">f64</span> <span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">MAXIMUM_NUMBER_OF_ITERATIONS</span>: <span class="kt">u32</span> <span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">EPSILON</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">xn</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">f_xn</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">g_xn</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">f_xn</span><span class="p">.</span><span class="n">abs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">EPSILON</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensens_method.                                                */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="k">fn</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span>: <span class="kt">f64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">f64</span> <span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*  Main routine used for testing our implementation of Steffensen&#39;s method.  */</span>
<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">X</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sqrt_x</span>: <span class="kt">f64</span> <span class="o">=</span><span class="w"> </span><span class="n">steffensens_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">);</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;sqrt({}) = {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_x</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<h2 id="py">Py<br /></h2>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">################################################################################</span>
<span class="sd">#                                   LICENSE                                    #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   This file is part of mitx_mathematics_programming_examples.                #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   mitx_mathematics_programming_examples is free software: you can            #</span>
<span class="sd">#   redistribute it and/or modify it under the terms of the GNU General Public #</span>
<span class="sd">#   License as published by the Free Software Foundation, either version 3 of  #</span>
<span class="sd">#   the License, or (at your option) any later version.                        #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   mitx_mathematics_programming_examples is distributed in the hope that it   #</span>
<span class="sd">#   will be useful, but WITHOUT ANY WARRANTY; without even the implied         #</span>
<span class="sd">#   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  #</span>
<span class="sd">#   GNU General Public License for more details.                               #</span>
<span class="sd">#                                                                              #</span>
<span class="sd">#   You should have received a copy of the GNU General Public License          #</span>
<span class="sd">#   along with mitx_mathematics_programming_examples.  If not, see             #</span>
<span class="sd">#   &lt;https://www.gnu.org/licenses/&gt;.                                           #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   Purpose:                                                                   #</span>
<span class="sd">#       Calculates roots of a function using Steffensen&#39;s method.              #</span>
<span class="sd">################################################################################</span>
<span class="sd">#   Author:     Ryan Maguire                                                   #</span>
<span class="sd">#   Date:       May 25, 2025.                                                  #</span>
<span class="sd">################################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Pylint doesn&#39;t like &quot;x&quot; as a variable name. Disable this warning.</span>
<span class="c1"># pylint: disable = invalid-name</span>

<span class="c1"># Computes the root of a function via Steffensen&#39;s method.</span>
<span class="k">def</span> <span class="nf">steffensen</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function:</span>
<span class="sd">            steffensen</span>
<span class="sd">        Purpose:</span>
<span class="sd">            Computes the root of a function f: R -&gt; R.</span>
<span class="sd">        Arguments:</span>
<span class="sd">            f (function):</span>
<span class="sd">                A function f: R -&gt; R. The root of f is computed.</span>
<span class="sd">            x (float):</span>
<span class="sd">                The guess point for the root of f.</span>
<span class="sd">        Output:</span>
<span class="sd">            root (float):</span>
<span class="sd">                A root of the function f near x.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Steffensen&#39;s method is iterative. The convergence is quadratic, meaning</span>
    <span class="c1"># the number of accurate decimals doubles with each iteration. Because of</span>
    <span class="c1"># this we can halt the algorithm after a few steps.</span>
    <span class="n">maximum_number_of_iterations</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="c1"># Maximum allowed error. This is 4x double precision epsilon.</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">8.881784197001252E-16</span>

    <span class="c1"># Steffensen&#39;s method starts the process at the guess point.</span>
    <span class="n">xn</span> <span class="o">=</span> <span class="n">x</span>

    <span class="c1"># Iteratively perform Steffensen&#39;s method.</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maximum_number_of_iterations</span><span class="p">):</span>

        <span class="c1"># Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
        <span class="c1"># in particular the denominator is f(x + f(x)) / f(x) - 1.</span>
        <span class="n">f_xn</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
        <span class="n">g_xn</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xn</span> <span class="o">+</span> <span class="n">f_xn</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_xn</span> <span class="o">-</span> <span class="mf">1.0</span>

        <span class="c1"># Like Newton&#39;s method the new point is obtained by subtracting</span>
        <span class="c1"># the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative</span>
        <span class="c1"># of f, but we do not explicitly need to calculate f&#39;(x).</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">xn</span> <span class="o">-</span> <span class="n">f_xn</span> <span class="o">/</span> <span class="n">g_xn</span>

        <span class="c1"># If f(x) is very small, we are close to a root and can break</span>
        <span class="c1"># out of this for loop. Check for this.</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
    <span class="c1"># quadratic. After a few iterations we will be very to close a root.</span>
    <span class="k">return</span> <span class="n">xn</span>

<span class="c1"># Input function for Steffensen&#39;s method.</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes f(x) = 2 - x^2. sqrt(2) is a root of this, we can compute</span>
<span class="sd">        this value by applying Steffensen&#39;s method to this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

<span class="c1"># 2 is close enough to sqrt(2) for Steffensen&#39;s method to work.</span>
<span class="n">X</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="c1"># Compute sqrt(2) using Steffensen&#39;s method and print the result.</span>
<span class="n">sqrt_2</span> <span class="o">=</span> <span class="n">steffensen</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sqrt(2) = </span><span class="si">{</span><span class="n">sqrt_2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

<h2 id="m">M<br /></h2>
<div class="highlight"><pre><span></span><span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%                                   LICENSE                                    %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   This file is part of mitx_mathematics_programming_examples.                %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   mitx_mathematics_programming_examples is free software: you can            %</span>
<span class="c">%   redistribute it and/or modify it under the terms of the GNU General Public %</span>
<span class="c">%   License as published by the Free Software Foundation, either version 3 of  %</span>
<span class="c">%   the License, or (at your option) any later version.                        %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   mitx_mathematics_programming_examples is distributed in the hope that it   %</span>
<span class="c">%   will be useful, but WITHOUT ANY WARRANTY; without even the implied         %</span>
<span class="c">%   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  %</span>
<span class="c">%   GNU General Public License for more details.                               %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   You should have received a copy of the GNU General Public License          %</span>
<span class="c">%   along with mitx_mathematics_programming_examples.  If not, see             %</span>
<span class="c">%   &lt;https://www.gnu.org/licenses/&gt;.                                           %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Purpose:                                                                   %</span>
<span class="c">%       Calculates roots of a function using Steffensen&#39;s method.              %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Author:     Ryan Maguire                                                   %</span>
<span class="c">%   Date:       May 25, 2025.                                                  %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Function:                                                                  %</span>
<span class="c">%       steffensen                                                             %</span>
<span class="c">%   Purpose:                                                                   %</span>
<span class="c">%       Computes the root of a function f: R -&gt; R.                             %</span>
<span class="c">%   Arguments:                                                                 %</span>
<span class="c">%       f (function):                                                          %</span>
<span class="c">%           A function f: R -&gt; R. The root of f is computed.                   %</span>
<span class="c">%       x (float):                                                             %</span>
<span class="c">%           The guess point for the root of f.                                 %</span>
<span class="c">%   Output:                                                                    %</span>
<span class="c">%       root (float):                                                          %</span>
<span class="c">%           A root of the function f near x.                                   %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="k">function</span><span class="w"> </span>root<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">steffensen</span><span class="p">(</span>f, x<span class="p">)</span>

<span class="w">    </span><span class="c">% Steffensen&#39;s method is iterative. The convergence is quadratic, meaning</span>
<span class="w">    </span><span class="c">% the number of accurate decimals doubles with each iteration. Because of</span>
<span class="w">    </span><span class="c">% this we can halt the algorithm after a few steps.</span>
<span class="w">    </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Maximum allowed error. This is 4x double precision epsilon.</span>
<span class="w">    </span><span class="n">epsilon</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Steffensen&#39;s method starts the process at the guess point.</span>
<span class="w">    </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Iteratively perform Steffensen&#39;s method.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">maximum_number_of_iterations</span>

<span class="w">        </span><span class="c">% Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
<span class="w">        </span><span class="c">% in particular the denominator is f(x + f(x)) / f(x) - 1.</span>
<span class="w">        </span><span class="n">f_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">        </span><span class="n">g_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="c">% Like Newton&#39;s method the new point is obtained by subtracting</span>
<span class="w">        </span><span class="c">% the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative</span>
<span class="w">        </span><span class="c">% of f, but we do not explicitly need to calculate f&#39;(x).</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">        </span><span class="c">% If f(x) is very small, we are close to a root and can break</span>
<span class="w">        </span><span class="c">% out of this for loop. Check for this.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">;</span>
<span class="w">            </span><span class="n">root</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c">% Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
<span class="w">    </span><span class="c">% quadratic. After a few iterations we will be very to close a root.</span>
<span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="k">end</span>

<span class="c">% Input function for Steffensen&#39;s method.</span>
<span class="k">function</span><span class="w"> </span>out<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span>x<span class="p">)</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="k">end</span>

<span class="c">% 2 is close enough to sqrt(2) for Steffensen&#39;s method to work.</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="c">% Compute sqrt(2) using Steffensen&#39;s method.</span>
<span class="n">sqrt_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">steffensen</span><span class="p">(@</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;sqrt(2) = %.16f\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_2</span><span class="p">);</span>
</pre></div>

<h2 id="d">D<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Create an alias for real-valued functions f: R -&gt; R.                      */</span>
<span class="k">alias</span><span class="w"> </span><span class="n">realfunc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="k">pure</span><span class="w"> </span><span class="k">nothrow</span><span class="w"> </span><span class="nd">@nogc</span><span class="w"> </span><span class="nd">@safe</span><span class="p">;</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">steffensens_method</span><span class="p">(</span><span class="n">realfunc</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*  Floating-point absolute value (fabs) provided here.                   */</span>
<span class="w">    </span><span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">math</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">fabs</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16U</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Variable for keeping track of how many iterations we have performed.  */</span>
<span class="w">    </span><span class="kt">uint</span><span class="w"> </span><span class="n">iters</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iters</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="p">;</span><span class="w"> </span><span class="p">++</span><span class="n">iters</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">g_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;=</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensens_method.                                                */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="k">pure</span><span class="w"> </span><span class="k">nothrow</span><span class="w"> </span><span class="nd">@nogc</span><span class="w"> </span><span class="nd">@safe</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="n">x</span><span class="p">*</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of func.                                                              */</span>

<span class="cm">/*  Main routine used for testing our implementation of Steffensen&#39;s method.  */</span>
<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*  stdio contains &quot;printf&quot;, used for printing text.                      */</span>
<span class="w">    </span><span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">printf</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt_x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">steffensens_method</span><span class="p">(&amp;</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;sqrt(%.1f) = %.16f\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_x</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h2 id="cpp">Cpp<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  cstdio provides the &quot;printf&quot; function, used for printing text.            */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdio&gt;</span>

<span class="cm">/*  Floating-point absolute value function, fabs, provided here.              */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cmath&gt;</span>

<span class="cm">/*  Function pointer notation is a little confusing. Create a typedef for it  *</span>
<span class="cm"> *  so we do not need to explicitly use it later.                             */</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">function</span><span class="p">)(</span><span class="kt">double</span><span class="p">);</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Steffensen</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16U</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  We want the function visible outside the class. Declare it public.    */</span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span>

<span class="w">        </span><span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.        */</span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">root</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/*  Maximum allowed error. This is 4x double precision epsilon.   */</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  Variable keeping track of how many iterations we perform.     */</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">iters</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  The method starts at the guess point and updates iteratively. */</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.       */</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">iters</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/*  Steffensen&#39;s method needs both f(x) and f(x + f(x)),      *</span>
<span class="cm">                 *  in particular the denominator is f(x + f(x)) / f(x) - 1.  */</span>
<span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">g_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">                </span><span class="cm">/*  Like Newton&#39;s method the new point is obtained by         *</span>
<span class="cm">                 *  subtracting the ratio. g(x) = f(x + f(x))/f(x) - 1 acts   *</span>
<span class="cm">                 *  as the derivative of f, but we do not explicitly need to  *</span>
<span class="cm">                 *  calculate f&#39;(x).                                          */</span>
<span class="w">                </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">                </span><span class="cm">/*  If f(x) is very small, we are close to a root and can     *</span>
<span class="cm">                 *  break out of this for loop. Check for this.               */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">fabs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="cm">/*  Like Newton&#39;s method and Heron&#39;s method, the convergence is   *</span>
<span class="cm">             *  quadratic. After a few iterations we will be close a root.    */</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="cm">/*  End of root.                                                      */</span>
<span class="p">};</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of func.                                                              */</span>

<span class="cm">/*  Main routine used for testing our implementation of Steffensen&#39;s method.  */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Steffensen</span><span class="o">::</span><span class="n">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;sqrt(%.1f) = %.16f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_x</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h2 id="go">Go<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="cm">/*  Only standard library imports are needed.                                 */</span>
<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span><span class="w">   </span><span class="cm">/*  Printf provided here, used for printing text to the screen.   */</span>
<span class="w">    </span><span class="s">&quot;math&quot;</span><span class="w">  </span><span class="cm">/*  Abs, floating-point absolute value function, found here.      */</span>
<span class="p">)</span>

<span class="cm">/*  Type for a function of the form f: R -&gt; R.                                */</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">realfunc</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="kt">float64</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">steffensens_method</span><span class="p">(</span><span class="nx">f</span><span class="w"> </span><span class="nx">realfunc</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maximum_number_of_iterations</span><span class="w"> </span><span class="kt">uint32</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">epsilon</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span>

<span class="w">    </span><span class="cm">/*  Variable for keeping track of how many iterations we have performed.  */</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="kt">uint32</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">xn</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">x</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">maximum_number_of_iterations</span><span class="p">;</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">f_xn</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="p">)</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">g_xn</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="nx">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">g_xn</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">Abs</span><span class="p">(</span><span class="nx">f_xn</span><span class="p">)</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">epsilon</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xn</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensens_method.                                                */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span>
<span class="p">}</span>
<span class="cm">/*  End of func.                                                              */</span>

<span class="cm">/*  Main routine used for testing our implementation of Steffensen&#39;s method.  */</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">sqrt_x</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">steffensens_method</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;sqrt(%.1f) = %.16f\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">sqrt_x</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<h2 id="c3">C3<br /></h2>

<h2 id="swift">Swift<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  fabs (floating-point absolute value) found here.                          */</span>
<span class="kd">import</span> <span class="nc">Foundation</span>

<span class="cm">/*  Type for a function of the form f: R -&gt; R.                                */</span>
<span class="kd">typealias</span> <span class="n">RealFunc</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Double</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Double</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="kd">func</span> <span class="nf">steffensensMethod</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">RealFunc</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">Double</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Double</span> <span class="p">{</span>

    <span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
    <span class="kd">let</span> <span class="nv">maximum_number_of_iterations</span><span class="p">:</span> <span class="nb">UInt32</span> <span class="p">=</span> <span class="mi">16</span>

    <span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
    <span class="kd">let</span> <span class="nv">epsilon</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="mf">8.881784197001252E-16</span>

    <span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
    <span class="kd">var</span> <span class="nv">xn</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">x</span>

    <span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
    <span class="k">for</span> <span class="kc">_</span> <span class="k">in</span> <span class="mi">0</span> <span class="p">..</span><span class="o">&lt;</span> <span class="n">maximum_number_of_iterations</span> <span class="p">{</span>

        <span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
        <span class="kd">let</span> <span class="nv">f_xn</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
        <span class="kd">let</span> <span class="nv">g_xn</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xn</span> <span class="o">+</span> <span class="n">f_xn</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_xn</span> <span class="o">-</span> <span class="mf">1.0</span>

        <span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
        <span class="n">xn</span> <span class="p">=</span> <span class="n">xn</span> <span class="o">-</span> <span class="n">f_xn</span> <span class="o">/</span> <span class="n">g_xn</span>

        <span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
        <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
    <span class="k">return</span> <span class="n">xn</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensensMethod.                                                 */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="kd">func</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">Double</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Double</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="p">}</span>

<span class="cm">/*  The initial guess point for Steffensen&#39;s method.                          */</span>
<span class="kd">let</span> <span class="nv">x</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="mf">2.0</span>

<span class="cm">/*  Calculate the square root and print it to the screen. If we have          *</span>
<span class="cm"> *  written things correctly, we should get 1.414..., which is sqrt(2).       */</span>
<span class="kd">let</span> <span class="nv">sqrt_x</span><span class="p">:</span> <span class="nb">Double</span> <span class="p">=</span> <span class="n">steffensensMethod</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="bp">print</span><span class="p">(</span><span class="s">&quot;sqrt(</span><span class="si">\(</span><span class="n">x</span><span class="si">)</span><span class="s">) = </span><span class="si">\(</span><span class="n">sqrt_x</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>

<h2 id="java">Java<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/25                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Class providing an implementation of Steffensen&#39;s method.                 */</span>
<span class="kd">final</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Steffensen</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Interface used for defining functions of the type f: R -&gt; R.          */</span>
<span class="w">    </span><span class="kd">interface</span> <span class="nc">Function</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maximumNumberOfIterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.            */</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">root</span><span class="p">(</span><span class="n">Function</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  Variable for keeping track of how many iterations we perform.     */</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iters</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  The method starts at the guess point and updates iteratively.     */</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.           */</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maximumNumberOfIterations</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">iters</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x+f(x)), *</span>
<span class="cm">             *  in particular the denominator is f(x + f(x)) / f(x) - 1.      */</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">            </span><span class="kt">double</span><span class="w"> </span><span class="n">g_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  Like Newton&#39;s method the new point is obtained by subtracting *</span>
<span class="cm">             *  the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative *</span>
<span class="cm">             *  of f, but we do not explicitly need to calculate f&#39;(x).       */</span>
<span class="w">            </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break   *</span>
<span class="cm">             *  out of this for loop. Check for this.                         */</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="na">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is *</span>
<span class="cm">         *  quadratic. After a few iterations we will be very to close a root.*/</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/*  End of root.                                                          */</span>

<span class="w">    </span><span class="cm">/*  Main routine used for testing our Steffensen implementation.          */</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  Our guess point for sqrt(2). 2 is close enough for Steffensen&#39;s   *</span>
<span class="cm">         *  method to work.                                                   */</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Create a function that evaluates 2 - x^2. sqrt(2) is a root.      */</span>
<span class="w">        </span><span class="n">Function</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Function</span><span class="p">()</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have  *</span>
<span class="cm">         *  written things correctly we should get 1.414..., which is sqrt(2).*/</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Steffensen</span><span class="p">.</span><span class="na">root</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;pi = %.16f\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="c">C<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/04/17                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  stdio.h provides the &quot;printf&quot; function, used for printing text.           */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cm">/*  Floating-point absolute value function, fabs, provided here.              */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>

<span class="cm">/*  Function pointer notation is a little confusing. Create a typedef for it  *</span>
<span class="cm"> *  so we do not need to explicitly use it later.                             */</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">function</span><span class="p">)(</span><span class="kt">double</span><span class="p">);</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">steffensens_method</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16U</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Variable for keeping track of how many iterations we have performed.  */</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">iters</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">iters</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">g_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensens_method.                                                */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of func.                                                              */</span>

<span class="cm">/*  Main routine used for testing our implementation of Steffensen&#39;s method.  */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">steffensens_method</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;sqrt(%.1f) = %.16f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_x</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h2 id="jl">Jl<br /></h2>
<div class="highlight"><pre><span></span><span class="c">################################################################################</span>
<span class="c">#                                   LICENSE                                    #</span>
<span class="c">################################################################################</span>
<span class="c">#   This file is part of mitx_mathematics_programming_examples.                #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   mitx_mathematics_programming_examples is free software: you can            #</span>
<span class="c">#   redistribute it and/or modify it under the terms of the GNU General Public #</span>
<span class="c">#   License as published by the Free Software Foundation, either version 3 of  #</span>
<span class="c">#   the License, or (at your option) any later version.                        #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   mitx_mathematics_programming_examples is distributed in the hope that it   #</span>
<span class="c">#   will be useful, but WITHOUT ANY WARRANTY; without even the implied         #</span>
<span class="c">#   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  #</span>
<span class="c">#   GNU General Public License for more details.                               #</span>
<span class="c">#                                                                              #</span>
<span class="c">#   You should have received a copy of the GNU General Public License          #</span>
<span class="c">#   along with mitx_mathematics_programming_examples.  If not, see             #</span>
<span class="c">#   &lt;https://www.gnu.org/licenses/&gt;.                                           #</span>
<span class="c">################################################################################</span>
<span class="c">#   Purpose:                                                                   #</span>
<span class="c">#       Calculates roots of a function using Steffensen&#39;s method.              #</span>
<span class="c">################################################################################</span>
<span class="c">#   Author:     Ryan Maguire                                                   #</span>
<span class="c">#   Date:       May 25, 2025.                                                  #</span>
<span class="c">################################################################################</span>

<span class="c">################################################################################</span>
<span class="c">#   Function:                                                                  #</span>
<span class="c">#       steffensen                                                             #</span>
<span class="c">#   Purpose:                                                                   #</span>
<span class="c">#       Computes the root of a function f: R -&gt; R.                             #</span>
<span class="c">#   Arguments:                                                                 #</span>
<span class="c">#       f (function):                                                          #</span>
<span class="c">#           A function f: R -&gt; R. The root of f is computed.                   #</span>
<span class="c">#       x (float):                                                             #</span>
<span class="c">#           The guess point for the root of f.                                 #</span>
<span class="c">#   Output:                                                                    #</span>
<span class="c">#       root (float):                                                          #</span>
<span class="c">#           A root of the function f near x.                                   #</span>
<span class="c">################################################################################</span>
<span class="k">function</span><span class="w"> </span><span class="n">steffensen</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>

<span class="w">    </span><span class="c"># Steffensen&#39;s method is iterative. The convergence is quadratic, meaning</span>
<span class="w">    </span><span class="c"># the number of accurate decimals doubles with each iteration. Because of</span>
<span class="w">    </span><span class="c"># this we can halt the algorithm after a few steps.</span>
<span class="w">    </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span>

<span class="w">    </span><span class="c"># Maximum allowed error. This is 4x double precision epsilon.</span>
<span class="w">    </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span>

<span class="w">    </span><span class="c"># Steffensen&#39;s method starts the process at the guess point.</span>
<span class="w">    </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>

<span class="w">    </span><span class="c"># Iteratively perform Steffensen&#39;s method.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">maximum_number_of_iterations</span>

<span class="w">        </span><span class="c"># Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
<span class="w">        </span><span class="c"># in particular the denominator is f(x + f(x)) / f(x) - 1.</span>
<span class="w">        </span><span class="n">f_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
<span class="w">        </span><span class="n">g_xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span>

<span class="w">        </span><span class="c"># Like Newton&#39;s method the new point is obtained by subtracting</span>
<span class="w">        </span><span class="c"># the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative</span>
<span class="w">        </span><span class="c"># of f, but we do not explicitly need to calculate f&#39;(x).</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span>

<span class="w">        </span><span class="c"># If f(x) is very small, we are close to a root and can break</span>
<span class="w">        </span><span class="c"># out of this for loop. Check for this.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c"># Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
<span class="w">    </span><span class="c"># quadratic. After a few iterations we will be very to close a root.</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span>
<span class="k">end</span>

<span class="c"># Input function for Steffensen&#39;s method.</span>
<span class="k">function</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        Computes f(x) = 2 - x^2. sqrt(2) is a root of this, we can compute</span>
<span class="s">        this value by applying Steffensen&#39;s method to this function.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="k">end</span>

<span class="c"># 2 is close enough to sqrt(2) for Steffensen&#39;s method to work.</span>
<span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>

<span class="c"># Compute sqrt(2) using Steffensen&#39;s method and print the result.</span>
<span class="n">sqrt_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">steffensen</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;sqrt(2) = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_2</span><span class="p">)</span>
</pre></div>

<h2 id="ts">Ts<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/22                                                        *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cm">/*  Type for a function of the form f: R -&gt; R.                                */</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">realfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">steffensensMethod</span><span class="p">(</span><span class="nx">f</span><span class="o">:</span><span class="w"> </span><span class="kt">realfunc</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">EPSILON</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">xn</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Variable for keeping track of how many iterations we perform.         */</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">iters</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">iters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">iters</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">MAXIMUM_NUMBER_OF_ITERATIONS</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">iters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">fXn</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">gXn</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fXn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">fXn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="nx">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">fXn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">gXn</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">fXn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">EPSILON</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xn</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensensMethod.                                                 */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*  The initial guess point for Steffensen&#39;s method.                          */</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="cm">/*  Calculate the square root and print it to the screen. If we have          *</span>
<span class="cm"> *  written things correctly, we should get 1.414..., which is sqrt(2).       */</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">sqrtX</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">steffensensMethod</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;sqrt(&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;) = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">sqrtX</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">16</span><span class="p">));</span>
</pre></div>

<h2 id="m-1">M<br /></h2>
<div class="highlight"><pre><span></span><span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%                                   LICENSE                                    %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   This file is part of mitx_mathematics_programming_examples.                %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   mitx_mathematics_programming_examples is free software: you can            %</span>
<span class="c">%   redistribute it and/or modify it under the terms of the GNU General Public %</span>
<span class="c">%   License as published by the Free Software Foundation, either version 3 of  %</span>
<span class="c">%   the License, or (at your option) any later version.                        %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   mitx_mathematics_programming_examples is distributed in the hope that it   %</span>
<span class="c">%   will be useful, but WITHOUT ANY WARRANTY; without even the implied         %</span>
<span class="c">%   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  %</span>
<span class="c">%   GNU General Public License for more details.                               %</span>
<span class="c">%                                                                              %</span>
<span class="c">%   You should have received a copy of the GNU General Public License          %</span>
<span class="c">%   along with mitx_mathematics_programming_examples.  If not, see             %</span>
<span class="c">%   &lt;https://www.gnu.org/licenses/&gt;.                                           %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Purpose:                                                                   %</span>
<span class="c">%       Calculates roots of a function using Steffensen&#39;s method.              %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Author:     Ryan Maguire                                                   %</span>
<span class="c">%   Date:       May 25, 2025.                                                  %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c">%   Function:                                                                  %</span>
<span class="c">%       steffensen                                                             %</span>
<span class="c">%   Purpose:                                                                   %</span>
<span class="c">%       Computes the root of a function f: R -&gt; R.                             %</span>
<span class="c">%   Arguments:                                                                 %</span>
<span class="c">%       f (function):                                                          %</span>
<span class="c">%           A function f: R -&gt; R. The root of f is computed.                   %</span>
<span class="c">%       x (float):                                                             %</span>
<span class="c">%           The guess point for the root of f.                                 %</span>
<span class="c">%   Output:                                                                    %</span>
<span class="c">%       root (float):                                                          %</span>
<span class="c">%           A root of the function f near x.                                   %</span>
<span class="c">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="k">function</span><span class="w"> </span>root<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">steffensen</span><span class="p">(</span>f, x<span class="p">)</span>

<span class="w">    </span><span class="c">% Steffensen&#39;s method is iterative. The convergence is quadratic, meaning</span>
<span class="w">    </span><span class="c">% the number of accurate decimals doubles with each iteration. Because of</span>
<span class="w">    </span><span class="c">% this we can halt the algorithm after a few steps.</span>
<span class="w">    </span><span class="n">maximum_number_of_iterations</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Maximum allowed error. This is 4x double precision epsilon.</span>
<span class="w">    </span><span class="n">epsilon</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Steffensen&#39;s method starts the process at the guess point.</span>
<span class="w">    </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Iteratively perform Steffensen&#39;s method.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">maximum_number_of_iterations</span>

<span class="w">        </span><span class="c">% Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),</span>
<span class="w">        </span><span class="c">% in particular the denominator is f(x + f(x)) / f(x) - 1.</span>
<span class="w">        </span><span class="n">f_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">);</span>
<span class="w">        </span><span class="n">g_xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">        </span><span class="c">% Like Newton&#39;s method the new point is obtained by subtracting</span>
<span class="w">        </span><span class="c">% the ratio. g(x) = f(x + f(x))/f(x) - 1 acts as the derivative</span>
<span class="w">        </span><span class="c">% of f, but we do not explicitly need to calculate f&#39;(x).</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span><span class="p">;</span>

<span class="w">        </span><span class="c">% If f(x) is very small, we are close to a root and can break</span>
<span class="w">        </span><span class="c">% out of this for loop. Check for this.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">;</span>
<span class="w">            </span><span class="n">root</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c">% Like Newton&#39;s method, and like Heron&#39;s method, the convergence is</span>
<span class="w">    </span><span class="c">% quadratic. After a few iterations we will be very to close a root.</span>
<span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">xn</span><span class="p">;</span>
<span class="k">end</span>

<span class="c">% Input function for Steffensen&#39;s method.</span>
<span class="k">function</span><span class="w"> </span>out<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span>x<span class="p">)</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="k">end</span>

<span class="c">% 2 is close enough to sqrt(2) for Steffensen&#39;s method to work.</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="c">% Compute sqrt(2) using Steffensen&#39;s method.</span>
<span class="n">sqrt_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">steffensen</span><span class="p">(@</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;sqrt(2) = %.16f\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt_2</span><span class="p">);</span>
</pre></div>

<h2 id="pro">Pro<br /></h2>
<div class="highlight"><pre><span></span><span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>                                   <span class="nv">LICENSE</span>                                    <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">This</span> <span class="s s-Atom">file</span> <span class="o">is</span> <span class="s s-Atom">part</span> <span class="s s-Atom">of</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>                <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">free</span> <span class="nn">software</span><span class="p">:</span> <span class="s s-Atom">you</span> <span class="s s-Atom">can</span>            <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">redistribute</span> <span class="s s-Atom">it</span> <span class="s s-Atom">and</span><span class="o">/</span><span class="s s-Atom">or</span> <span class="s s-Atom">modify</span> <span class="s s-Atom">it</span> <span class="s s-Atom">under</span> <span class="s s-Atom">the</span> <span class="s s-Atom">terms</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="p">;</span>
<span class="p">;</span>   <span class="nv">License</span> <span class="s s-Atom">as</span> <span class="s s-Atom">published</span> <span class="s s-Atom">by</span> <span class="s s-Atom">the</span> <span class="nv">Free</span> <span class="nv">Software</span> <span class="nv">Foundation</span><span class="p">,</span> <span class="s s-Atom">either</span> <span class="s s-Atom">version</span> <span class="mi">3</span> <span class="s s-Atom">of</span>  <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">the</span> <span class="nv">License</span><span class="p">,</span> <span class="nf">or</span> <span class="p">(</span><span class="s s-Atom">at</span> <span class="s s-Atom">your</span> <span class="s s-Atom">option</span><span class="p">)</span> <span class="s s-Atom">any</span> <span class="s s-Atom">later</span> <span class="s s-Atom">version</span><span class="p">.</span>                        <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">distributed</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">hope</span> <span class="s s-Atom">that</span> <span class="s s-Atom">it</span>   <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">will</span> <span class="s s-Atom">be</span> <span class="s s-Atom">useful</span> <span class="s s-Atom">but</span> <span class="nv">WITHOUT</span> <span class="nv">ANY</span> <span class="nv">WARRANTY</span><span class="p">;</span> <span class="s s-Atom">without</span> <span class="s s-Atom">even</span> <span class="s s-Atom">the</span> <span class="s s-Atom">implied</span> <span class="s s-Atom">warranty</span> <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">of</span> <span class="nv">MERCHANTABILITY</span> <span class="s s-Atom">or</span> <span class="nv">FITNESS</span> <span class="nv">FOR</span> <span class="nv">A</span> <span class="nv">PARTICULAR</span> <span class="nv">PURPOSE</span><span class="p">.</span>  <span class="nv">See</span> <span class="s s-Atom">the</span>           <span class="p">;</span>
<span class="p">;</span>   <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span> <span class="s s-Atom">for</span> <span class="s s-Atom">more</span> <span class="s s-Atom">details</span><span class="p">.</span>                               <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="nv">You</span> <span class="s s-Atom">should</span> <span class="s s-Atom">have</span> <span class="s s-Atom">received</span> <span class="s s-Atom">a</span> <span class="s s-Atom">copy</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span>          <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">along</span> <span class="s s-Atom">with</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>  <span class="nv">If</span> <span class="o">not</span><span class="p">,</span> <span class="s s-Atom">see</span>             <span class="p">;</span>
<span class="p">;</span>   <span class="o">&lt;</span><span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">www</span><span class="p">.</span><span class="s s-Atom">gnu</span><span class="p">.</span><span class="s s-Atom">org</span><span class="o">/</span><span class="s s-Atom">licenses/&gt;.</span>                                           <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Purpose</span><span class="s s-Atom">:</span>                                                                   <span class="p">;</span>
<span class="p">;</span>       <span class="nv">Calculates</span> <span class="s s-Atom">roots</span> <span class="s s-Atom">using</span> <span class="nv">Steffensen</span><span class="s s-Atom">&#39;s method.                            ;</span>
<span class="s s-Atom">;------------------------------------------------------------------------------;</span>
<span class="s s-Atom">;   Author: Ryan Maguire                                                       ;</span>
<span class="s s-Atom">;   Date:   2025/05/22                                                         ;</span>
<span class="s s-Atom">;------------------------------------------------------------------------------;</span>
<span class="s s-Atom">FUNCTION STEFFENSEN, F, X</span>

<span class="s s-Atom">    ; Tells the compiler that integers should be 32 bits, not 16.</span>
<span class="s s-Atom">    COMPILE_OPT IDL2</span>

<span class="s s-Atom">    ; Error checking code.</span>
<span class="s s-Atom">    ON_ERROR, 2</span>

<span class="s s-Atom">    ; Steffensen&#39;s</span> <span class="s s-Atom">method</span> <span class="o">is</span> <span class="s s-Atom">iterative</span><span class="p">.</span> <span class="nv">The</span> <span class="s s-Atom">convergence</span> <span class="o">is</span> <span class="s s-Atom">quadratic</span><span class="p">,</span> <span class="s s-Atom">meaning</span>
    <span class="p">;</span> <span class="s s-Atom">the</span> <span class="s s-Atom">number</span> <span class="s s-Atom">of</span> <span class="s s-Atom">accurate</span> <span class="s s-Atom">decimals</span> <span class="s s-Atom">doubles</span> <span class="s s-Atom">with</span> <span class="s s-Atom">each</span> <span class="s s-Atom">iteration</span><span class="p">.</span> <span class="nv">Because</span> <span class="s s-Atom">of</span>
    <span class="p">;</span> <span class="s s-Atom">this</span> <span class="s s-Atom">we</span> <span class="s s-Atom">can</span> <span class="s s-Atom">halt</span> <span class="s s-Atom">the</span> <span class="s s-Atom">algorithm</span> <span class="s s-Atom">after</span> <span class="s s-Atom">a</span> <span class="s s-Atom">few</span> <span class="s s-Atom">steps</span><span class="p">.</span>
    <span class="nv">MAXIMUM_NUMBER_OF_ITERATIONS</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="p">;</span> <span class="nv">Maximum</span> <span class="s s-Atom">allowed</span> <span class="s s-Atom">error</span><span class="p">.</span> <span class="nv">This</span> <span class="o">is</span> <span class="mi">4</span><span class="s s-Atom">x</span> <span class="s s-Atom">double</span> <span class="s s-Atom">precision</span> <span class="s s-Atom">epsilon</span><span class="p">.</span>
    <span class="nv">EPSILON</span> <span class="o">=</span> <span class="mf">8.881784197001252E-16</span>

    <span class="p">;</span> <span class="nv">Variable</span> <span class="s s-Atom">used</span> <span class="s s-Atom">for</span> <span class="nv">Steffensen</span><span class="s s-Atom">&#39;s approximation. We will iteratively update</span>
<span class="s s-Atom">    ; this value with better approximations using Steffensen&#39;s</span> <span class="s s-Atom">method</span><span class="p">.</span>
    <span class="nv">XN</span> <span class="o">=</span> <span class="nv">X</span>

    <span class="p">;</span> <span class="nv">Iteratively</span> <span class="s s-Atom">perform</span> <span class="nv">Steffensen</span><span class="s s-Atom">&#39;s method.</span>
<span class="s s-Atom">    FOR ITERS = 1, MAXIMUM_NUMBER_OF_ITERATIONS DO BEGIN</span>

<span class="s s-Atom">        ; Steffensen&#39;s</span> <span class="s s-Atom">method</span> <span class="s s-Atom">needs</span> <span class="s s-Atom">the</span> <span class="s s-Atom">evaluations</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">)</span> <span class="s s-Atom">and</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span> <span class="o">+</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">)),</span>
        <span class="p">;</span> <span class="s s-Atom">in</span> <span class="s s-Atom">particular</span> <span class="s s-Atom">the</span> <span class="s s-Atom">denominator</span> <span class="o">is</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span> <span class="o">+</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">))</span> <span class="o">/</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="nv">Compute</span><span class="p">.</span>
        <span class="nv">F_XN</span> <span class="o">=</span> <span class="nv">CALL_FUNCTION</span><span class="p">(</span><span class="nv">F</span><span class="p">,</span> <span class="nv">XN</span><span class="p">)</span>
        <span class="nv">G_XN</span> <span class="o">=</span> <span class="nv">CALL_FUNCTION</span><span class="p">(</span><span class="nv">F</span><span class="p">,</span> <span class="nv">XN</span> <span class="o">+</span> <span class="nv">F_XN</span><span class="p">)</span> <span class="o">/</span> <span class="nv">F_XN</span> <span class="o">-</span> <span class="mf">1.0</span>

        <span class="p">;</span> <span class="nv">Like</span> <span class="nv">Newton</span><span class="s s-Atom">&#39;s method, the new point is obtained by subtracting</span>
<span class="s s-Atom">        ; the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative</span>
<span class="s s-Atom">        ; of f, but we do not explicitly need to calculate f&#39;</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">).</span>
        <span class="nv">XN</span> <span class="o">=</span> <span class="nv">XN</span> <span class="o">-</span> <span class="nv">F_XN</span> <span class="o">/</span> <span class="nv">G_XN</span>

        <span class="p">;</span> <span class="nv">If</span> <span class="nf">f</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">)</span> <span class="o">is</span> <span class="s s-Atom">very</span> <span class="s s-Atom">small</span><span class="p">,</span> <span class="s s-Atom">we</span> <span class="s s-Atom">are</span> <span class="s s-Atom">close</span> <span class="s s-Atom">to</span> <span class="s s-Atom">a</span> <span class="s s-Atom">root</span> <span class="s s-Atom">and</span> <span class="s s-Atom">can</span> <span class="s s-Atom">break</span> <span class="s s-Atom">out</span>
        <span class="p">;</span> <span class="s s-Atom">of</span> <span class="s s-Atom">this</span> <span class="s s-Atom">for</span> <span class="s s-Atom">loop</span><span class="p">.</span> <span class="nv">Check</span> <span class="s s-Atom">for</span> <span class="s s-Atom">this</span><span class="p">.</span>
        <span class="nv">IF</span> <span class="p">(</span><span class="nv">ABS</span><span class="p">(</span><span class="nv">F_XN</span><span class="p">)</span> <span class="nv">LE</span> <span class="nv">EPSILON</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BREAK</span>

    <span class="nv">END</span>

    <span class="p">;</span> <span class="nv">Like</span> <span class="nv">Newton</span><span class="s s-Atom">&#39;s method, and like Heron&#39;s</span> <span class="s s-Atom">method</span><span class="p">,</span> <span class="s s-Atom">the</span> <span class="s s-Atom">convergence</span> <span class="o">is</span>
    <span class="p">;</span> <span class="s s-Atom">quadratic</span><span class="p">.</span> <span class="nv">After</span> <span class="s s-Atom">a</span> <span class="s s-Atom">few</span> <span class="s s-Atom">iterations</span> <span class="s s-Atom">we</span> <span class="s s-Atom">will</span> <span class="s s-Atom">be</span> <span class="s s-Atom">very</span> <span class="s s-Atom">to</span> <span class="s s-Atom">close</span> <span class="s s-Atom">a</span> <span class="s s-Atom">root</span><span class="p">.</span>
    <span class="nv">RETURN</span><span class="p">,</span> <span class="nv">XN</span>

<span class="nv">END</span>

<span class="p">;</span> <span class="nf">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">is</span> <span class="s s-Atom">the</span> <span class="s s-Atom">root</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">function</span> <span class="mi">2</span> <span class="o">-</span> <span class="s s-Atom">x^</span><span class="mf">2.</span> <span class="nv">Define</span> <span class="s s-Atom">this</span><span class="p">.</span>
<span class="nv">FUNCTION</span> <span class="nv">FUNC</span><span class="p">,</span> <span class="nv">X</span>

    <span class="nv">COMPILE_OPT</span> <span class="nv">IDL2</span>
    <span class="nv">RETURN</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="nv">X</span><span class="o">*</span><span class="nv">X</span>

<span class="nv">END</span>

<span class="p">;</span> <span class="nv">Program</span> <span class="s s-Atom">for</span> <span class="s s-Atom">testing</span> <span class="s s-Atom">our</span> <span class="s s-Atom">implementation</span> <span class="s s-Atom">of</span> <span class="nv">Steffensen</span><span class="s s-Atom">&#39;s method.</span>
<span class="s s-Atom">PRO MAIN</span>

<span class="s s-Atom">    COMPILE_OPT IDL2</span>

<span class="s s-Atom">    ; The input for the method. We&#39;ll</span> <span class="s s-Atom">compute</span> <span class="nf">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span>
    <span class="nv">X</span> <span class="o">=</span> <span class="nv">DOUBLE</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="p">;</span> <span class="nv">Run</span> <span class="s s-Atom">the</span> <span class="s s-Atom">routine</span><span class="p">,</span> <span class="s s-Atom">computing</span> <span class="nf">sqrt</span><span class="p">(</span><span class="s s-Atom">x</span><span class="p">),</span> <span class="s s-Atom">and</span> <span class="s s-Atom">print</span> <span class="s s-Atom">the</span> <span class="s s-Atom">result</span><span class="p">.</span>
    <span class="nv">SQRT_2</span> <span class="o">=</span> <span class="nv">STEFFENSEN</span><span class="p">(</span><span class="s2">&quot;FUNC&quot;</span><span class="p">,</span> <span class="nv">X</span><span class="p">)</span>
    <span class="nv">PRINT</span><span class="p">,</span> <span class="nv">X</span><span class="p">,</span> <span class="nv">SQRT_2</span><span class="p">,</span> <span class="nv">FORMAT</span> <span class="o">=</span> <span class="s s-Atom">&#39;SQRT(%3.1f) = %18.16f&#39;</span>

<span class="nv">END</span>
</pre></div>

<h2 id="kt">Kt<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">/******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General       *</span>
<span class="cm"> *  Public License as published by the Free Software Foundation, either       *</span>
<span class="cm"> *  version 3 of the License, or (at your option) any later version.          *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that     *</span>
<span class="cm"> *  it will be useful but WITHOUT ANY WARRANTY; without even the implied      *</span>
<span class="cm"> *  warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.          *</span>
<span class="cm"> *  See the GNU General Public License for more details.                      *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples. If not, see             *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Calculates the root of a function using Steffensen&#39;s method.          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/25                                                        *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlin.math.abs</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlin.math.sin</span>

<span class="cm">/*  Type for a function of the form f: R -&gt; R.                                */</span>
<span class="k">typealias</span><span class="w"> </span><span class="n">RealFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">Double</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Double</span>

<span class="cm">/*  Computes the root of a function using Steffensen&#39;s method.                */</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">steffensensMethod</span><span class="p">(</span><span class="n">f</span><span class="p">:</span><span class="w"> </span><span class="n">RealFunc</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">):</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">maximum_number_of_iterations</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span>

<span class="w">    </span><span class="cm">/*  The maximum allowed error. This is 4x double precision epsilon.       */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">epsilon</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8.881784197001252E-16</span>

<span class="w">    </span><span class="cm">/*  The method starts at the provided guess point and updates iteratively.*/</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">xn</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>

<span class="w">    </span><span class="cm">/*  Iteratively apply Steffensen&#39;s method to find the root.               */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">iters</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="n">maximum_number_of_iterations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="cm">/*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. */</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">f_xn</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">g_xn</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1.0</span>

<span class="w">        </span><span class="cm">/*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           */</span>
<span class="w">        </span><span class="n">xn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_xn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_xn</span>

<span class="w">        </span><span class="cm">/*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">f_xn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">xn</span>
<span class="p">}</span>
<span class="cm">/*  End of steffensensMethod.                                                 */</span>

<span class="cm">/*  sqrt(2) is a root to the function f(x) = 2 - x^2. Provide this.           */</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">):</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="p">}</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*  The initial guess point for Steffensen&#39;s method.                      */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0</span>

<span class="w">    </span><span class="cm">/*  Calculate the square root and print it to the screen. If we have      *</span>
<span class="cm">     *  written things correctly, we should get 1.414..., which is sqrt(2).   */</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sqrt_x</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">steffensensMethod</span><span class="p">(</span><span class="o">::</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;sqrt(2) = </span><span class="si">$</span><span class="n">sqrt_x</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<h2 id="pas">Pas<br /></h2>
<div class="highlight"><pre><span></span><span class="cm">(******************************************************************************</span>
<span class="cm"> *                                  LICENSE                                   *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  This file is part of mitx_mathematics_programming_examples.               *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is free software: you can           *</span>
<span class="cm"> *  redistribute it and/or modify it under the terms of the GNU General Public*</span>
<span class="cm"> *  License as published by the Free Software Foundation, either version 3 of *</span>
<span class="cm"> *  the License, or (at your option) any later version.                       *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  mitx_mathematics_programming_examples is distributed in the hope that it  *</span>
<span class="cm"> *  will be useful but WITHOUT ANY WARRANTY; without even the implied warranty*</span>
<span class="cm"> *  of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the          *</span>
<span class="cm"> *  GNU General Public License for more details.                              *</span>
<span class="cm"> *                                                                            *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License         *</span>
<span class="cm"> *  along with mitx_mathematics_programming_examples.  If not, see            *</span>
<span class="cm"> *  &lt;https://www.gnu.org/licenses/&gt;.                                          *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Computes roots using Steffensen&#39;s method.                             *</span>
<span class="cm"> ******************************************************************************</span>
<span class="cm"> *  Author: Ryan Maguire                                                      *</span>
<span class="cm"> *  Date:   2025/05/25                                                        *</span>
<span class="cm"> ******************************************************************************)</span>
<span class="k">PROGRAM</span><span class="w"> </span><span class="n">Steffensen</span><span class="o">;</span>

<span class="cm">(*  We define two constants: The allowed tolerance (or epsilon value),        *</span>
<span class="cm"> *  and the maximum number of iterations we allow for Steffensen&#39;s method.    *)</span>
<span class="k">CONST</span>

<span class="w">    </span><span class="cm">(*  Steffensen&#39;s method is iterative and converges very quickly.          *</span>
<span class="cm">     *  Because of this we may exit the function after a few iterations.      *)</span>
<span class="w">    </span><span class="n">MaximumNumberOfIterations</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="o">;</span>

<span class="w">    </span><span class="cm">(*  The maximum allowed error. This is 4x double precision epsilon.       *)</span>
<span class="w">    </span><span class="n">Epsilon</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.881784197001252E-16</span><span class="o">;</span>

<span class="w">    </span><span class="cm">(*  2 is close enough to sqrt(2) for Steffensen&#39;s method to work.         *)</span>
<span class="w">    </span><span class="n">Guess</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="o">;</span>

<span class="cm">(*  Create an alias for real functions f: R -&gt; R. This makes the syntax of    *</span>
<span class="cm"> *  the parameters for SteffensensMethod function a little more readable.     *)</span>
<span class="k">TYPE</span>
<span class="w">    </span><span class="n">RealFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Function</span><span class="p">(</span><span class="k">Const</span><span class="w"> </span><span class="n">X</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="o">;</span>

<span class="cm">(*  The program has one variable, sqrt(2) computed via Steffensen&#39;s method.   *)</span>
<span class="k">VAR</span>
<span class="w">    </span><span class="n">Sqrt2</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="o">;</span>

<span class="cm">(*  f(x) = 2 - x^2 has sqrt(2) as a root. This is the input function.         *)</span>
<span class="k">Function</span><span class="w"> </span><span class="nf">Func</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="o">;</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="n">Func</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X</span><span class="o">*</span><span class="n">X</span><span class="o">;</span>
<span class="k">END</span><span class="o">;</span>

<span class="cm">(******************************************************************************</span>
<span class="cm"> *  Function:                                                                 *</span>
<span class="cm"> *      SteffensensMethod                                                     *</span>
<span class="cm"> *  Purpose:                                                                  *</span>
<span class="cm"> *      Computes roots using Steffensen&#39;s method.                             *</span>
<span class="cm"> *   Arguments:                                                               *</span>
<span class="cm"> *      F (RealFunc):                                                         *</span>
<span class="cm"> *          A continuous function f: R -&gt; R.                                  *</span>
<span class="cm"> *      X (Real):                                                             *</span>
<span class="cm"> *          The initial guess point for Steffensen&#39;s method.                  *</span>
<span class="cm"> *   OUTPUT:                                                                  *</span>
<span class="cm"> *       Root (Real):                                                         *</span>
<span class="cm"> *           A root for F near X.                                             *</span>
<span class="cm"> ******************************************************************************)</span>
<span class="k">Function</span><span class="w"> </span><span class="nf">SteffensensMethod</span><span class="p">(</span><span class="k">Const</span><span class="w"> </span><span class="n">F</span><span class="o">:</span><span class="w"> </span><span class="n">RealFunc</span><span class="o">;</span><span class="w"> </span><span class="k">Const</span><span class="w"> </span><span class="n">X</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="o">;</span>

<span class="k">VAR</span>
<span class="w">    </span><span class="cm">(*  Steffensen&#39;s method is iterative, like Newton&#39;s method, but avoids    *</span>
<span class="cm">     *  explicit use of the derivative of F. Instead it uses the function     *</span>
<span class="cm">     *  G(x) = F(x + F(x)) / F(X) - 1, which acts like F&#39;(x). Provide a       *</span>
<span class="cm">     *  variable for each of these expressions, Xn is the nth approximation.  *)</span>
<span class="w">    </span><span class="n">Xn</span><span class="o">,</span><span class="w"> </span><span class="n">Fxn</span><span class="o">,</span><span class="w"> </span><span class="n">Gxn</span><span class="o">:</span><span class="w"> </span><span class="kt">Real</span><span class="o">;</span>

<span class="w">    </span><span class="cm">(*  Dummy variable for tracking how many iterations we&#39;ve performed.      *)</span>
<span class="w">    </span><span class="n">Iters</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>

<span class="k">BEGIN</span>

<span class="w">    </span><span class="cm">(*  Steffensen&#39;s method starts the iterative process at the guess point.  *)</span>
<span class="w">    </span><span class="n">Xn</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">X</span><span class="o">;</span>

<span class="w">    </span><span class="cm">(*  Iteratively perform Steffensen&#39;s method.                              *)</span>
<span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="n">Iters</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">MaximumNumberOfIterations</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DO</span>
<span class="w">    </span><span class="k">BEGIN</span>

<span class="w">        </span><span class="cm">(*  Steffensen&#39;s method needs the evaluations f(x) and f(x + f(x)),   *</span>
<span class="cm">         *  in particular the denominator is f(x + f(x)) / f(x) - 1. Compute. *)</span>
<span class="w">        </span><span class="n">Fxn</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">Xn</span><span class="p">)</span><span class="o">;</span>
<span class="w">        </span><span class="n">Gxn</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">Xn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Fxn</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Fxn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="o">;</span>

<span class="w">        </span><span class="cm">(*  Like Newton&#39;s method, the new point is obtained by subtracting    *</span>
<span class="cm">         *  the ratio. g(x) = f(x + f(x)) / f(x) - 1 acts as the derivative   *</span>
<span class="cm">         *  of f, but we do not explicitly need to calculate f&#39;(x).           *)</span>
<span class="w">        </span><span class="n">Xn</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Xn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Fxn</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Gxn</span><span class="o">;</span>

<span class="w">        </span><span class="cm">(*  If f(x) is very small, we are close to a root and can break out   *</span>
<span class="cm">         *  of this for loop. Check for this.                                 *)</span>
<span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Fxn</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Epsilon</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">BREAK</span><span class="o">;</span>

<span class="w">    </span><span class="k">END</span><span class="o">;</span>

<span class="w">    </span><span class="cm">(*  Like Newton&#39;s method, and like Heron&#39;s method, the convergence is     *</span>
<span class="cm">     *  quadratic. After a few iterations we will be very to close a root.    *)</span>
<span class="w">    </span><span class="n">SteffensensMethod</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Xn</span><span class="o">;</span>
<span class="k">END</span><span class="o">;</span>

<span class="cm">(*  Program for testing our implementation of Steffensen&#39;s method.            *)</span>
<span class="k">BEGIN</span>

<span class="w">    </span><span class="cm">(*  Compute sqrt(2) using Steffensen&#39;s method and print the result.       *)</span>
<span class="w">    </span><span class="n">Sqrt2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">SteffensensMethod</span><span class="p">(</span><span class="o">@</span><span class="n">Func</span><span class="o">,</span><span class="w"> </span><span class="n">Guess</span><span class="p">)</span><span class="o">;</span>
<span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">&#39;sqrt(2) = &#39;</span><span class="o">,</span><span class="w"> </span><span class="n">Sqrt2</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">16</span><span class="p">)</span><span class="o">;</span>

<span class="k">END</span><span class="o">.</span>
</pre></div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ryan Maguire</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ryan Maguire</li><li><a class="u-email" href="mailto:rmaguire@protonmail.com">rmaguire@protonmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ryanmaguire"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ryanmaguire</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Mathematics, Physics, and Programming</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
