<div class="highlight"><pre><span></span><span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>                                   <span class="nv">LICENSE</span>                                    <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">This</span> <span class="s s-Atom">file</span> <span class="o">is</span> <span class="s s-Atom">part</span> <span class="s s-Atom">of</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>                <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">free</span> <span class="nn">software</span><span class="p">:</span> <span class="s s-Atom">you</span> <span class="s s-Atom">can</span>            <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">redistribute</span> <span class="s s-Atom">it</span> <span class="s s-Atom">and</span><span class="o">/</span><span class="s s-Atom">or</span> <span class="s s-Atom">modify</span> <span class="s s-Atom">it</span> <span class="s s-Atom">under</span> <span class="s s-Atom">the</span> <span class="s s-Atom">terms</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="p">;</span>
<span class="p">;</span>   <span class="nv">License</span> <span class="s s-Atom">as</span> <span class="s s-Atom">published</span> <span class="s s-Atom">by</span> <span class="s s-Atom">the</span> <span class="nv">Free</span> <span class="nv">Software</span> <span class="nv">Foundation</span><span class="p">,</span> <span class="s s-Atom">either</span> <span class="s s-Atom">version</span> <span class="mi">3</span> <span class="s s-Atom">of</span>  <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">the</span> <span class="nv">License</span><span class="p">,</span> <span class="nf">or</span> <span class="p">(</span><span class="s s-Atom">at</span> <span class="s s-Atom">your</span> <span class="s s-Atom">option</span><span class="p">)</span> <span class="s s-Atom">any</span> <span class="s s-Atom">later</span> <span class="s s-Atom">version</span><span class="p">.</span>                        <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">mitx_mathematics_programming_examples</span> <span class="o">is</span> <span class="s s-Atom">distributed</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">hope</span> <span class="s s-Atom">that</span> <span class="s s-Atom">it</span>   <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">will</span> <span class="s s-Atom">be</span> <span class="s s-Atom">useful</span> <span class="s s-Atom">but</span> <span class="nv">WITHOUT</span> <span class="nv">ANY</span> <span class="nv">WARRANTY</span><span class="p">;</span> <span class="s s-Atom">without</span> <span class="s s-Atom">even</span> <span class="s s-Atom">the</span> <span class="s s-Atom">implied</span> <span class="s s-Atom">warranty</span> <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">of</span> <span class="nv">MERCHANTABILITY</span> <span class="s s-Atom">or</span> <span class="nv">FITNESS</span> <span class="nv">FOR</span> <span class="nv">A</span> <span class="nv">PARTICULAR</span> <span class="nv">PURPOSE</span><span class="p">.</span>  <span class="nv">See</span> <span class="s s-Atom">the</span>           <span class="p">;</span>
<span class="p">;</span>   <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span> <span class="s s-Atom">for</span> <span class="s s-Atom">more</span> <span class="s s-Atom">details</span><span class="p">.</span>                               <span class="p">;</span>
<span class="p">;</span>                                                                              <span class="p">;</span>
<span class="p">;</span>   <span class="nv">You</span> <span class="s s-Atom">should</span> <span class="s s-Atom">have</span> <span class="s s-Atom">received</span> <span class="s s-Atom">a</span> <span class="s s-Atom">copy</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="nv">GNU</span> <span class="nv">General</span> <span class="nv">Public</span> <span class="nv">License</span>          <span class="p">;</span>
<span class="p">;</span>   <span class="s s-Atom">along</span> <span class="s s-Atom">with</span> <span class="s s-Atom">mitx_mathematics_programming_examples</span><span class="p">.</span>  <span class="nv">If</span> <span class="o">not</span><span class="p">,</span> <span class="s s-Atom">see</span>             <span class="p">;</span>
<span class="p">;</span>   <span class="o">&lt;</span><span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="s s-Atom">www</span><span class="p">.</span><span class="s s-Atom">gnu</span><span class="p">.</span><span class="s s-Atom">org</span><span class="o">/</span><span class="s s-Atom">licenses/&gt;.</span>                                           <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Purpose</span><span class="s s-Atom">:</span>                                                                   <span class="p">;</span>
<span class="p">;</span>       <span class="nv">Calculates</span> <span class="s s-Atom">roots</span> <span class="s s-Atom">using</span> <span class="s s-Atom">the</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span><span class="p">.</span>                           <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Author</span><span class="s s-Atom">:</span> <span class="nv">Ryan</span> <span class="nv">Maguire</span>                                                       <span class="p">;</span>
<span class="p">;</span>   <span class="nv">Date</span><span class="s s-Atom">:</span>   <span class="mi">2025</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">09</span>                                                         <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>

<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="p">;</span>   <span class="nv">Function</span><span class="s s-Atom">:</span>                                                                  <span class="p">;</span>
<span class="p">;</span>       <span class="nv">BISECTION_METHOD</span>                                                       <span class="p">;</span>
<span class="p">;</span>   <span class="nv">Purpose</span><span class="s s-Atom">:</span>                                                                   <span class="p">;</span>
<span class="p">;</span>       <span class="nv">Computes</span> <span class="s s-Atom">roots</span> <span class="s s-Atom">using</span> <span class="s s-Atom">the</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span><span class="p">.</span>                             <span class="p">;</span>
<span class="p">;</span>   <span class="nv">Arguments</span><span class="s s-Atom">:</span>                                                                 <span class="p">;</span>
<span class="p">;</span>       <span class="nv">FUNC</span> <span class="p">(</span><span class="nv">FUNCTION</span><span class="p">)</span><span class="s s-Atom">:</span>                                                       <span class="p">;</span>
<span class="p">;</span>           <span class="nv">A</span> <span class="s s-Atom">function</span> <span class="s s-Atom">from</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">]</span> <span class="s s-Atom">to</span> <span class="s s-Atom">the</span> <span class="s s-Atom">real</span> <span class="s s-Atom">numbers</span><span class="p">.</span>                        <span class="p">;</span>
<span class="p">;</span>       <span class="nv">A</span> <span class="p">(</span><span class="nv">REAL</span><span class="p">)</span><span class="s s-Atom">:</span>                                                              <span class="p">;</span>
<span class="p">;</span>           <span class="nv">One</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">endpoints</span> <span class="s s-Atom">for</span> <span class="s s-Atom">the</span> <span class="s s-Atom">interval</span><span class="p">.</span>                             <span class="p">;</span>
<span class="p">;</span>       <span class="nv">B</span> <span class="p">(</span><span class="nv">REAL</span><span class="p">)</span><span class="s s-Atom">:</span>                                                              <span class="p">;</span>
<span class="p">;</span>           <span class="nv">The</span> <span class="s s-Atom">other</span> <span class="s s-Atom">the</span> <span class="s s-Atom">endpoint</span> <span class="s s-Atom">for</span> <span class="s s-Atom">the</span> <span class="s s-Atom">interval</span><span class="p">.</span>                           <span class="p">;</span>
<span class="p">;</span>   <span class="nv">OUTPUT</span><span class="s s-Atom">:</span>                                                                    <span class="p">;</span>
<span class="p">;</span>       <span class="nv">ROOT</span> <span class="p">(</span><span class="nv">REAL</span><span class="p">)</span><span class="s s-Atom">:</span>                                                           <span class="p">;</span>
<span class="p">;</span>           <span class="nv">A</span> <span class="s s-Atom">root</span> <span class="s s-Atom">for</span> <span class="nv">FUNC</span><span class="p">.</span>                                                   <span class="p">;</span>
<span class="p">;</span><span class="s s-Atom">------------------------------------------------------------------------------</span><span class="p">;</span>
<span class="nv">FUNCTION</span> <span class="nv">BISECTION_METHOD</span><span class="p">,</span> <span class="nv">FUNC</span><span class="p">,</span> <span class="nv">A</span><span class="p">,</span> <span class="nv">B</span>

    <span class="p">;</span> <span class="nv">Tells</span> <span class="s s-Atom">the</span> <span class="s s-Atom">compiler</span> <span class="s s-Atom">that</span> <span class="s s-Atom">integers</span> <span class="s s-Atom">should</span> <span class="s s-Atom">be</span> <span class="mi">32</span> <span class="s s-Atom">bits</span><span class="p">,</span> <span class="o">not</span> <span class="mf">16.</span>
    <span class="nv">COMPILE_OPT</span> <span class="nv">IDL2</span>

    <span class="p">;</span> <span class="nv">Error</span> <span class="s s-Atom">checking</span> <span class="s s-Atom">code</span><span class="p">.</span>
    <span class="nv">ON_ERROR</span><span class="p">,</span> <span class="mi">2</span>

    <span class="p">;</span> <span class="nv">Given</span> <span class="s s-Atom">a</span> <span class="s s-Atom">continuous</span> <span class="s s-Atom">function</span> <span class="s s-Atom">defined</span> <span class="s s-Atom">on</span> <span class="p">[</span><span class="s s-Atom">a</span><span class="p">,</span> <span class="s s-Atom">b</span><span class="p">],</span> <span class="s s-Atom">the</span> <span class="s s-Atom">nth</span> <span class="s s-Atom">iteration</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span>
    <span class="p">;</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span> <span class="o">is</span> <span class="s s-Atom">at</span> <span class="s s-Atom">most</span> <span class="p">|</span><span class="s s-Atom">b</span> <span class="o">-</span> <span class="s s-Atom">a</span><span class="p">|</span> <span class="o">/</span> <span class="mi">2</span><span class="s s-Atom">^n</span> <span class="s s-Atom">away</span> <span class="s s-Atom">from</span> <span class="s s-Atom">the</span> <span class="s s-Atom">root</span><span class="p">.</span> <span class="nv">A</span> <span class="s s-Atom">double</span>
    <span class="p">;</span> <span class="s s-Atom">precision</span> <span class="s s-Atom">number</span> <span class="s s-Atom">has</span> <span class="mi">52</span> <span class="s s-Atom">bits</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">mantissa</span><span class="p">,</span> <span class="s s-Atom">meaning</span> <span class="s s-Atom">if</span> <span class="p">|</span><span class="s s-Atom">b</span> <span class="o">-</span> <span class="s s-Atom">a</span><span class="p">|</span> <span class="s s-Atom">~=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">;</span> <span class="s s-Atom">then</span> <span class="s s-Atom">after</span> <span class="mi">52</span> <span class="s s-Atom">iterations</span> <span class="s s-Atom">we</span> <span class="s s-Atom">are</span> <span class="s s-Atom">as</span> <span class="s s-Atom">close</span> <span class="s s-Atom">to</span> <span class="s s-Atom">the</span> <span class="s s-Atom">root</span> <span class="s s-Atom">as</span> <span class="s s-Atom">we</span> <span class="s s-Atom">can</span> <span class="s s-Atom">get</span><span class="p">.</span>
    <span class="p">;</span> <span class="nv">To</span> <span class="s s-Atom">allow</span> <span class="s s-Atom">for</span> <span class="s s-Atom">a</span> <span class="s s-Atom">larger</span> <span class="s s-Atom">range</span><span class="p">,</span> <span class="s s-Atom">halt</span> <span class="s s-Atom">the</span> <span class="s s-Atom">algorithm</span> <span class="s s-Atom">after</span> <span class="mi">64</span> <span class="s s-Atom">iterations</span><span class="p">.</span>
    <span class="nv">MAXIMUM_NUMBER_OF_ITERATIONS</span> <span class="o">=</span> <span class="mi">64</span>

    <span class="p">;</span> <span class="nv">Maximum</span> <span class="s s-Atom">allowed</span> <span class="s s-Atom">error</span><span class="p">.</span> <span class="nv">This</span> <span class="o">is</span> <span class="s s-Atom">double</span> <span class="s s-Atom">precision</span> <span class="s s-Atom">epsilon</span><span class="p">.</span>
    <span class="nv">EPSILON</span> <span class="o">=</span> <span class="mf">2.220446049250313E-16</span>

    <span class="p">;</span> <span class="nv">Initial</span> <span class="s s-Atom">setup</span><span class="p">,</span> <span class="s s-Atom">find</span> <span class="s s-Atom">out</span> <span class="s s-Atom">which</span> <span class="s s-Atom">evaluation</span> <span class="o">is</span> <span class="s s-Atom">positive</span> <span class="s s-Atom">and</span> <span class="s s-Atom">which</span> <span class="o">is</span>
    <span class="p">;</span> <span class="s s-Atom">negative</span><span class="p">.</span> <span class="nv">If</span> <span class="s s-Atom">the</span> <span class="s s-Atom">signs</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">two</span> <span class="s s-Atom">agree</span> <span class="s s-Atom">we</span> <span class="s s-Atom">treat</span> <span class="s s-Atom">this</span> <span class="s s-Atom">as</span> <span class="s s-Atom">an</span> <span class="s s-Atom">error</span><span class="p">.</span>
    <span class="nv">A_EVAL</span> <span class="o">=</span> <span class="nv">CALL_FUNCTION</span><span class="p">(</span><span class="nv">FUNC</span><span class="p">,</span> <span class="nv">A</span><span class="p">)</span>
    <span class="nv">B_EVAL</span> <span class="o">=</span> <span class="nv">CALL_FUNCTION</span><span class="p">(</span><span class="nv">FUNC</span><span class="p">,</span> <span class="nv">B</span><span class="p">)</span>

    <span class="p">;</span> <span class="nv">Special</span> <span class="s s-Atom">case</span><span class="p">,</span> <span class="nv">A</span> <span class="o">is</span> <span class="s s-Atom">a</span> <span class="s s-Atom">root</span><span class="p">.</span> <span class="nv">Set</span> <span class="s s-Atom">the</span> <span class="s s-Atom">output</span> <span class="s s-Atom">to</span> <span class="nv">A</span> <span class="s s-Atom">and</span> <span class="s s-Atom">return</span><span class="p">.</span>
    <span class="nv">IF</span> <span class="p">(</span><span class="nv">ABS</span><span class="p">(</span><span class="nv">A_EVAL</span><span class="p">)</span> <span class="nv">LE</span> <span class="nv">EPSILON</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
        <span class="nv">RETURN</span><span class="p">,</span> <span class="nv">A</span>
    <span class="nv">ENDIF</span>

    <span class="p">;</span> <span class="nv">Similarly</span> <span class="s s-Atom">for</span> <span class="nv">B</span><span class="p">,</span> <span class="s s-Atom">if</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">B</span><span class="p">)</span> <span class="s s-Atom">~=</span> <span class="mi">0</span><span class="p">,</span> <span class="s s-Atom">return</span> <span class="nv">B</span><span class="p">.</span>
    <span class="nv">IF</span> <span class="p">(</span><span class="nv">ABS</span><span class="p">(</span><span class="nv">B_EVAL</span><span class="p">)</span> <span class="nv">LE</span> <span class="nv">EPSILON</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
        <span class="nv">RETURN</span><span class="p">,</span> <span class="nv">B</span>
    <span class="nv">ENDIF</span>

    <span class="p">;</span> <span class="nv">If</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">A</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">B</span><span class="p">),</span> <span class="s s-Atom">then</span> <span class="nv">LEFT</span> <span class="o">=</span> <span class="nv">A</span> <span class="s s-Atom">and</span> <span class="nv">RIGHT</span> <span class="o">=</span> <span class="nv">B</span><span class="p">.</span>
    <span class="nv">IF</span> <span class="p">(</span><span class="nv">A_EVAL</span> <span class="nv">LT</span> <span class="nv">B_EVAL</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>

        <span class="p">;</span> <span class="nv">If</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">A</span><span class="p">)</span> <span class="s s-Atom">and</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">B</span><span class="p">)</span> <span class="s s-Atom">have</span> <span class="s s-Atom">the</span> <span class="s s-Atom">same</span> <span class="nf">sign</span> <span class="p">(</span><span class="s s-Atom">both</span> <span class="s s-Atom">positive</span> <span class="s s-Atom">or</span>
        <span class="p">;</span> <span class="s s-Atom">both</span> <span class="s s-Atom">negative</span><span class="p">),</span> <span class="s s-Atom">return</span> <span class="nv">NaN</span><span class="p">.</span> <span class="nv">Bisection</span> <span class="o">is</span> <span class="s s-Atom">undefined</span><span class="p">.</span>
        <span class="nv">IF</span> <span class="p">((</span><span class="nv">A_EVAL</span> <span class="nv">GT</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">OR</span> <span class="p">(</span><span class="nv">B_EVAL</span> <span class="nv">LT</span> <span class="mi">0</span><span class="p">))</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
            <span class="nv">RETURN</span><span class="p">,</span> <span class="p">(</span><span class="nv">A</span> <span class="o">-</span> <span class="nv">A</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nv">A</span> <span class="o">-</span> <span class="nv">A</span><span class="p">)</span>
        <span class="nv">ENDIF</span>

        <span class="nv">LEFT</span> <span class="o">=</span> <span class="nv">A</span>
        <span class="nv">RIGHT</span> <span class="o">=</span> <span class="nv">B</span>

    <span class="p">;</span> <span class="nv">If</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">B</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">A</span><span class="p">),</span> <span class="s s-Atom">then</span> <span class="nv">LEFT</span> <span class="o">=</span> <span class="nv">B</span> <span class="s s-Atom">and</span> <span class="nv">RIGHT</span> <span class="o">=</span> <span class="nv">A</span><span class="p">.</span>
    <span class="nv">ENDIF</span> <span class="nv">ELSE</span> <span class="nv">BEGIN</span>

        <span class="p">;</span> <span class="nv">Same</span> <span class="s s-Atom">sanity</span> <span class="s s-Atom">check</span> <span class="s s-Atom">as</span> <span class="s s-Atom">before</span><span class="p">,</span> <span class="s s-Atom">make</span> <span class="s s-Atom">sure</span> <span class="s s-Atom">the</span> <span class="s s-Atom">signs</span> <span class="s s-Atom">are</span> <span class="s s-Atom">different</span><span class="p">.</span>
        <span class="nv">IF</span> <span class="p">((</span><span class="nv">A_EVAL</span> <span class="nv">LT</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">OR</span> <span class="p">(</span><span class="nv">B_EVAL</span> <span class="nv">GT</span> <span class="mi">0</span><span class="p">))</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
            <span class="nv">RETURN</span><span class="p">,</span> <span class="p">(</span><span class="nv">A</span> <span class="o">-</span> <span class="nv">A</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nv">A</span> <span class="o">-</span> <span class="nv">A</span><span class="p">)</span>
        <span class="nv">ENDIF</span>

        <span class="nv">LEFT</span> <span class="o">=</span> <span class="nv">B</span>
        <span class="nv">RIGHT</span> <span class="o">=</span> <span class="nv">A</span>
    <span class="nv">ENDELSE</span>

    <span class="nv">MIDPOINT</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nv">A</span> <span class="o">+</span> <span class="nv">B</span><span class="p">)</span>

    <span class="p">;</span> <span class="nv">Iteratively</span> <span class="s s-Atom">perform</span> <span class="s s-Atom">the</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span><span class="p">.</span>
    <span class="nv">FOR</span> <span class="nv">ITERS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">MAXIMUM_NUMBER_OF_ITERATIONS</span> <span class="nv">DO</span> <span class="nv">BEGIN</span>

        <span class="p">;</span> <span class="nv">The</span> <span class="s s-Atom">interval</span> <span class="o">is</span> <span class="s s-Atom">cut</span> <span class="s s-Atom">in</span> <span class="s s-Atom">half</span> <span class="s s-Atom">based</span> <span class="s s-Atom">on</span> <span class="s s-Atom">the</span> <span class="s s-Atom">sign</span> <span class="s s-Atom">of</span> <span class="nv">FUNC</span><span class="p">(</span><span class="nv">MIDPOINT</span><span class="p">).</span>
        <span class="p">;</span> <span class="nv">Compute</span> <span class="s s-Atom">this</span> <span class="s s-Atom">and</span> <span class="s s-Atom">compare</span><span class="p">.</span>
        <span class="nv">EVAL</span> <span class="o">=</span> <span class="nv">CALL_FUNCTION</span><span class="p">(</span><span class="nv">FUNC</span><span class="p">,</span> <span class="nv">MIDPOINT</span><span class="p">)</span>

        <span class="p">;</span> <span class="nv">If</span> <span class="nv">MIDPOINT</span> <span class="o">is</span> <span class="s s-Atom">close</span> <span class="s s-Atom">to</span> <span class="s s-Atom">a</span> <span class="s s-Atom">root</span> <span class="s s-Atom">we</span> <span class="s s-Atom">can</span> <span class="s s-Atom">exit</span> <span class="s s-Atom">the</span> <span class="s s-Atom">function</span><span class="p">.</span>
        <span class="nv">IF</span> <span class="p">(</span><span class="nv">ABS</span><span class="p">(</span><span class="nv">EVAL</span><span class="p">)</span> <span class="nv">LE</span> <span class="nv">EPSILON</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
            <span class="nv">BREAK</span>
        <span class="nv">ENDIF</span>

        <span class="p">;</span> <span class="nv">Otherwise</span><span class="p">,</span> <span class="s s-Atom">divide</span> <span class="s s-Atom">the</span> <span class="s s-Atom">range</span> <span class="s s-Atom">in</span> <span class="s s-Atom">half</span><span class="p">.</span> <span class="nv">If</span> <span class="nv">EVAL</span> <span class="o">is</span> <span class="s s-Atom">negative</span> <span class="s s-Atom">we</span>
        <span class="p">;</span> <span class="s s-Atom">replace</span> <span class="nv">LEFT</span> <span class="s s-Atom">with</span> <span class="nv">MIDPOINT</span> <span class="s s-Atom">and</span> <span class="s s-Atom">move</span> <span class="nv">MIDPOINT</span> <span class="s s-Atom">closer</span> <span class="s s-Atom">to</span> <span class="nv">RIGHT</span><span class="p">.</span>
        <span class="nv">IF</span> <span class="p">(</span><span class="nv">EVAL</span> <span class="nv">LT</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">THEN</span> <span class="nv">BEGIN</span>
            <span class="nv">LEFT</span> <span class="o">=</span> <span class="nv">MIDPOINT</span>
            <span class="nv">MIDPOINT</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nv">MIDPOINT</span> <span class="o">+</span> <span class="nv">RIGHT</span><span class="p">)</span>

        <span class="p">;</span> <span class="nv">Likewise</span><span class="p">,</span> <span class="s s-Atom">if</span> <span class="nv">EVAL</span> <span class="o">is</span> <span class="s s-Atom">positive</span><span class="p">,</span> <span class="s s-Atom">replace</span> <span class="nv">RIGHT</span> <span class="s s-Atom">with</span> <span class="nv">MIDPOINT</span> <span class="s s-Atom">and</span>
        <span class="p">;</span> <span class="s s-Atom">move</span> <span class="nv">MIDPOINT</span> <span class="s s-Atom">closer</span> <span class="s s-Atom">to</span> <span class="nv">LEFT</span><span class="p">.</span>
        <span class="nv">ENDIF</span> <span class="nv">ELSE</span> <span class="nv">BEGIN</span>
            <span class="nv">RIGHT</span> <span class="o">=</span> <span class="nv">MIDPOINT</span>
            <span class="nv">MIDPOINT</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nv">LEFT</span> <span class="o">+</span> <span class="nv">MIDPOINT</span><span class="p">)</span>
        <span class="nv">ENDELSE</span>
    <span class="nv">END</span>

    <span class="p">;</span> <span class="nv">Provided</span> <span class="p">|</span><span class="nv">B</span> <span class="o">-</span> <span class="nv">A</span><span class="p">|</span> <span class="o">is</span> <span class="o">not</span> <span class="s s-Atom">too</span> <span class="s s-Atom">big</span><span class="p">,</span> <span class="s s-Atom">we</span> <span class="s s-Atom">should</span> <span class="s s-Atom">now</span> <span class="s s-Atom">have</span> <span class="s s-Atom">a</span> <span class="s s-Atom">very</span> <span class="s s-Atom">good</span>
    <span class="p">;</span> <span class="s s-Atom">approximation</span> <span class="s s-Atom">to</span> <span class="s s-Atom">the</span> <span class="s s-Atom">root</span><span class="p">.</span>
    <span class="nv">RETURN</span><span class="p">,</span> <span class="nv">MIDPOINT</span>
<span class="nv">END</span>

<span class="p">;</span> <span class="nv">Program</span> <span class="s s-Atom">for</span> <span class="s s-Atom">testing</span> <span class="s s-Atom">our</span> <span class="s s-Atom">implementation</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">bisection</span> <span class="s s-Atom">method</span><span class="p">.</span>
<span class="nv">PRO</span> <span class="nv">MAIN</span>

    <span class="p">;</span> <span class="nv">Tells</span> <span class="s s-Atom">the</span> <span class="s s-Atom">compiler</span> <span class="s s-Atom">that</span> <span class="s s-Atom">integers</span> <span class="s s-Atom">should</span> <span class="s s-Atom">be</span> <span class="mi">32</span> <span class="s s-Atom">bits</span><span class="p">,</span> <span class="o">not</span> <span class="mf">16.</span>
    <span class="nv">COMPILE_OPT</span> <span class="nv">IDL2</span>

    <span class="p">;</span> <span class="nv">Pi</span> <span class="o">is</span> <span class="s s-Atom">somewhere</span> <span class="s s-Atom">between</span> <span class="mi">3</span> <span class="s s-Atom">and</span> <span class="mi">4</span><span class="p">,</span> <span class="s s-Atom">use</span> <span class="s s-Atom">this</span> <span class="s s-Atom">interval</span><span class="p">.</span>
    <span class="nv">A</span> <span class="o">=</span> <span class="nv">DOUBLE</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
    <span class="nv">B</span> <span class="o">=</span> <span class="nv">DOUBLE</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="p">;</span> <span class="nv">Run</span> <span class="s s-Atom">the</span> <span class="s s-Atom">routine</span><span class="p">,</span> <span class="s s-Atom">compute</span> <span class="s s-Atom">pi</span><span class="p">,</span> <span class="s s-Atom">and</span> <span class="s s-Atom">print</span> <span class="s s-Atom">the</span> <span class="s s-Atom">result</span><span class="p">.</span>
    <span class="nv">PI_BY_BISECTION</span> <span class="o">=</span> <span class="nv">BISECTION_METHOD</span><span class="p">(</span><span class="s2">&quot;SIN&quot;</span><span class="p">,</span> <span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">)</span>
    <span class="nv">PRINT</span><span class="p">,</span> <span class="nv">PI_BY_BISECTION</span><span class="p">,</span> <span class="nv">FORMAT</span> <span class="o">=</span> <span class="s s-Atom">&#39;PI = %18.16f&#39;</span>

<span class="nv">END</span>
</pre></div>
